#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\begin_preamble
\usepackage{listings} 
\usepackage{algorithm,algpseudocode}
\usepackage{xcolor}
\usepackage{setspace}
\definecolor{darkgreen}{cmyk}{0.5, 0, 1, 0.5}
\definecolor{lightgray}{gray}{0.6}
\usepackage{xcolor-solarized}
\usepackage[many,listings]{tcolorbox}

\pagenumbering{roman}


\usepackage[T1]{fontenc}
\usepackage{beramono}
\end_preamble
\options usenames,dvipsnames
\use_default_options true
\begin_modules
logicalmkup
eqs-within-sections
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\float_placement H
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 0
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 0
\use_package mhchem 1
\use_package stackrel 0
\use_package stmaryrd 0
\use_package undertilde 0
\cite_engine natbib
\cite_engine_type numerical
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\listings_params "language=Python,frame=single,breaklines=true,commentstyle={\color{solarized-green}\itshape},backgroundcolor={\color{solarized-base3}},fillcolor={\color{solarized-base02}},keywordstyle={\color{solarized-red}},stringstyle={\color{solarized-cyan}},numberstyle={color\solarized-blue}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Author
Mo Houshmand
\end_layout

\begin_layout Title
Master Thesis 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Part*
Acknowledgements 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
They said he knows the last digit of pi, and that he can divide by 0.
 Mikael Mortensen doesn’t need a debugger, he just stares down the bug until
 the code confesses.
 He doesn’t even get compiler errors, the language changes itself to accommodate
 Mikael.
 
\end_layout

\begin_layout Plain Layout
MM can write multi-threaded applications with a single thread.
\end_layout

\begin_layout Plain Layout
MM .
\end_layout

\begin_layout Plain Layout
MM can compile syntax errors.
\end_layout

\begin_layout Plain Layout
MM types with 2 fingers.
 He points them at the keyboard and the keyboard does the rest.
\end_layout

\begin_layout Plain Layout
MM computed all primes… in his sleep
\end_layout

\begin_layout Plain Layout
Mikael doesn't waste his words
\end_layout

\begin_layout Plain Layout
Chuck Norris keyboard have f13
\end_layout

\begin_layout Plain Layout
Once I witnessed Mikael switch the computer on with his eyes!
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{arabic} 
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{page}{1}
\end_layout

\begin_layout Plain Layout


\backslash
frenchspacing
\end_layout

\begin_layout Plain Layout


\backslash
raggedbottom
\end_layout

\begin_layout Plain Layout


\backslash
pagestyle{plain}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

def kam(t, u, 3.8, "gh"):
\end_layout

\begin_layout Plain Layout

	for i in range(len(a):
\end_layout

\begin_layout Plain Layout

		print i
\end_layout

\begin_layout Plain Layout

numberstyle={
\backslash
xcolor{solarized-blue}} 
\end_layout

\begin_layout Plain Layout

keywords={[1]{ if , else , for, while, return}} keywordstyle     = [1]
\backslash
color{solarized-green}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Flex Emph
status open

\begin_layout Plain Layout
Direct numerical simulation
\end_layout

\end_inset

 (DNS) is the branch of Computational Fluid Dynamics (CFD) dedicated to
 high-end solutions of turbulence flows governed by the Navier-Stokes equations
 
\begin_inset CommandInset citation
LatexCommand cite
key "coleman2010primer"

\end_inset

.
 Compared to conventional CFD solvers, DNS resolves the Navier-Stokes equations
 explicitly rather than closure modeling like the Reynolds averaged Navier-Stoke
s (RANS) or Large eddy simulation (LES) where sub-grid scale modeling is
 necessary in order to include the smallest, unresolved eddies.
 The greatest strength of DNS is its ability to provide a complete and detailed
 knowledge of the turbulence flow at any given time and point in space,
 without leaning on any approximation.
 It captures the whole range of turbulence, from the smallest scales (Kolmogorov
 micro-scales) associated with dissipation, to the largest integral length
 scale 
\begin_inset Formula $L$
\end_inset

 associated with the kinetic energy.
 DNS is an ideal method for turbulence research.
 However, these promising abilities comes at a high price; extreme computational
 cost and severe restriction on the maximum Reynolds number.
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
 ...
 .
 choosing appropriate mesh resolution for the task may be demanding..
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Wrap figure
lines 0
placement o
overhang 0col%
width "50col%"
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/ArtGeometry.png
	scale 30

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Details-of-the-geometry"

\end_inset

Details of the geometry with expanded bifurcation 
\begin_inset CommandInset citation
LatexCommand cite
key "kolaas2013visualization"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The purpose of this master thesis is to carefully run DNS simulations in
 an effort to reproduce the experimental data in a recent study 
\begin_inset CommandInset citation
LatexCommand cite
key "kolaas2013visualization"

\end_inset

 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
This study was conducted at the Microfluidics Laboratory at SINTEF MiNaLab,
 as a joint project with the Hydrodynamics laboratory at the University
 of Oslo.
 
\end_layout

\end_inset

.
 The main objective in this study was to investigate the kinematic properties
 of flow in silicon micro-channels by the method of particle tracking velocimetr
y PTV.
 Both stationary and pulsatile flows was generated in two different rectangularl
y Y-shaped geometries; with and without an expanded bifurcation fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Details-of-the-geometry"

\end_inset

).
 Distinct difference in the flow regimes where found between the geometries,
 where flow separation was observed only for the geometry with the expanded
 bifurcation at 
\begin_inset Formula $\textrm{Re}=84$
\end_inset

.
 The chosen geometries in the experiment was motivated from biomedical flow
 in order to emulate blood flow in a capillary bifurcation with an aneurysm.
 An aneurysm occurs when the walls between a capillary bifurcation weakens
 and gradually expand to form a balloon like sac.
 In most cases an aneurysm goes unnoticed without any symptoms, but in rare
 cases an aneurysm that is formed in the brain may rapture and cause serious
 and life threatening conditions like stroke, where the blood is released
 into the skull.
 Although these rectangularly rigid walled geometries are not realistic
 compared to real life blood flow in capillaries, they give a good comparison
 to the numerical results.
 
\end_layout

\begin_layout Standard
The governing equations are discretized spatially by the finite element
 method (FEM) and temporally by fractional step methods.
 The simulations are performed with 
\begin_inset Flex Emph
status open

\begin_layout Plain Layout
FEniCS
\end_layout

\end_inset

 - a software designed to automate the solution of differential equations
 based on the FEM 
\begin_inset CommandInset citation
LatexCommand cite
key "logg2012automated"

\end_inset

.
 In particular, we will use Oasis 
\begin_inset CommandInset citation
LatexCommand cite
key "mortensen2015oasis"

\end_inset

, a high performance and a highly versatile Navier-Stokes solver based on
 the building blocks from the FEniCS project.
 
\end_layout

\begin_layout Standard
To this end we address these following problem statements: 
\end_layout

\begin_layout Itemize
Find the appropriate value of the resistance coefficient 
\begin_inset Formula $C$
\end_inset

 in the resistance boundary condition (RBC) such that the ratio of the outflows
 converge to a reasonable number, and we get a similar streamline pattern
 comparable to the experiment.
 
\end_layout

\begin_layout Itemize
In which way does the chosen method and mesh resolution influence the computatio
nal costs? 
\end_layout

\begin_layout Itemize
The Navier-Stokes equations will always results in solving a large number
 of sparse linear systems 
\begin_inset CommandInset citation
LatexCommand cite
key "segal2012finite"

\end_inset

.
 In general, the solution of these systems and the storage of the corresponding
 matrices takes the major part of the resources in terms of CPU time and
 memory.
 How can we make the solution methods more efficient.
 (a review)
\end_layout

\begin_layout Itemize
Discrepancies between experiments and simulations?
\end_layout

\begin_layout Standard
A complete documentation for this master can be found
\end_layout

\begin_layout Standard
\begin_inset CommandInset href
LatexCommand href
target "https://bitbucket.org/MoHoushmand/master-thesis"

\end_inset


\end_layout

\begin_layout Subsection
Organization
\end_layout

\begin_layout Subsection
Literature review
\end_layout

\begin_layout Subsubsection
Microfluidics
\end_layout

\begin_layout Standard
Microfluidics is a multidisciplinary scientific field of systems that process
 or manipulate minuscule amount of fluids, typically in the range of 
\begin_inset Formula $10^{-3}$
\end_inset

 to 
\begin_inset Formula $10^{-12}$
\end_inset

 
\begin_inset Formula $\mu\textrm{L}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "lin2011microfluidics"

\end_inset

.
 As a technology, microfluidic offers many advantages and useful capabilities;
 the ability to use small samples and reagents, low cost, short analysis
 time, small footprints, and being capable to carry out separation and detection
 with high resolution and sensitivity.
 Initially, this technology was developed to manufacture microprocessors
 and to miniaturize transistors, which would later make it possible to produce
 microscopic channels and integrate them on chips.
 
\end_layout

\begin_layout Standard
The first lab on chip (LOC) analysis system was first proposed by 
\begin_inset CommandInset citation
LatexCommand cite
key "terry1979gas"

\end_inset

, where a miniature gas analysis system was built based on the principles
 of gas chromatography.
 The major components was fabricated in silicon using photolithography and
 chemical etching techniques, which allowed at that time, size reductions
 of nearly three orders of magnitude compared to conventional laboratory
 instruments.
 Photolithography is a process used in micro-fabrication
\emph on
 
\emph default
where light is used to transfer a geometric pattern from a photo-stencil
 to a light-sensitive chemical photoresist on to a substrate.
 Further chemical processing then either engraves or deposes to achieve
 desired pattern on the material of choice.
 Although, originally developed for chromatograph and expected for applications
 in the areas of portable ambient air quality monitors, planetary probes,
 this would later turn out to intersect many scientific fields 
\begin_inset CommandInset citation
LatexCommand cite
key "sackmann2014present"

\end_inset

.
 
\end_layout

\begin_layout Standard
The development of chemical and biological weapons during the cold war was
 countered by the US Defense to fund and support a series of programs with
 the main target of developing microfluidic systems designed to function
 as detectors for these threats 
\begin_inset CommandInset citation
LatexCommand cite
key "whitesides2006origins"

\end_inset

.
 These programs were the main source for the rapid growth of academic microfluid
ic technology.
 In the 80's, a new type of device emerged called Micro Electro Mechanical
 Systems or MEMS, based on silicon etching procedures developed for microelectro
nics industry.
 This development made it possible to manufacture the first device containing
 movable micro-elements integrated on a silicon wafer, giving rise to applicatio
ns in the fields of pressure sensors and printer heads.
 Many researchers started to investigated in the applications of MEMS and
 started to develop laboratories on a chip which would enable the integration
 of almost all diagnostic operations performed in a hospital on a single
 microfluidic chip.
 The majority of microfluidic devices were still made of either silicon
 or glass which required the heavy infrastructure of the microelectronics
 industry.
 
\end_layout

\begin_layout Standard
Starting millennium, technologies based on molding micro-channels in polymers
 such as PDMS grew gradually and started to replace microfluidic devices
 made of silicon or glass.
 Cost and production time of these decreased and enabled a large number
 of laboratories to conduct researches in microfluidics.
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
For biological sample analysis, microfluidic devices made on silicon or
 glass appears to be unsuitable or inappropriate.
 Especially silicon is expensive.
 It also is opaque to UV and visible light, making it inappropriate for
 conventional optical methods for detection.
 Neither glass or silicon has all the required properties for work with
 living mammalian cells, in particular, the permeability to gases is required.
\end_layout

\end_inset

 Many exploratory microfluidics research has been done with polymer, mainly
 PDMS, which has distinct properties from those of silicone.
 
\end_layout

\begin_layout Standard
Thousands of researchers are today working with microfluidics to extend
 its application fields, particularly towards biomedicine, biology and chemistry.
 Two especially important contributions in the fabrication process of microfluid
ic devices are soft lithography in PDMS, and pneumatically activated pumps,
 valves and mixers based on soft-lithographic procedures.
 These method have shortened the fabrication process of prototypes dramatically.
 In particular, quake’s pneumatic valves has been important as they have
 made it possible to design and examine complicated devices, which in turn
 opened up a number of areas of applications.
 
\end_layout

\begin_layout Standard
With new fabrication methods, microfluidics has revealed some fundamental
 differences between fluid flow in large channels and those in micro-channels.
 The most important differences are are seen in turbulence; in macro scale
 flow, fluids mix convectively, e.g.
 milk stirred in coffee suggests that inertia is typically more important
 then viscosity.
 However, when water is used as fluid in micro-channels, the opposite appears
 to be true; fluids does not mix convectively.
 In fact, when to fluids streams together in micro-channels, they flow in
 a parallel stream where turbulence and eddies are absent.
 The only mixing is due to molecular diffusion across the interface between
 those fluids.
 One particularly important parameter in the study of fluid flow is the
 Reynolds number.
 This number represents the ratio of inertial forces to viscous forces and
 gives an indication of whether a flow is laminar or turbulent 
\begin_inset CommandInset citation
LatexCommand cite
key "langtangen2002numerical"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\textrm{Re}=\frac{uL}{\nu}\label{eq:Re}
\end{equation}

\end_inset

where 
\begin_inset Formula $u$
\end_inset

 
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$u$"
description "Velocity component"

\end_inset

is the maximum velocity, 
\begin_inset Formula $L$
\end_inset


\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$l$"
description "Characteristic length scale"

\end_inset

 is the characteristic length scale and 
\begin_inset Formula $\nu$
\end_inset

 
\begin_inset CommandInset nomenclature
LatexCommand nomenclature
symbol "$\\nu$"
description "Kinematic viscocity"

\end_inset

is the kinematic viscosity.
 Other important equations to be mentioned are: 
\end_layout

\begin_layout Subsubsection
Particle Tracking Velocimetry (PTV)
\end_layout

\begin_layout Standard
With particle image velocimetry(PIV) one aims to make accurate and quantitative
 measurement of the fluid velocity vectors at a very large number of points
 simultaneously 
\begin_inset CommandInset citation
LatexCommand cite
key "adrian2005twenty"

\end_inset

.
 In 1977, three groups of researchers independently achieved to make such
 measurements by the method of Laser Speckle Velocimetry (LSV), [Barker
 and Fourney, 1977], [Dudderar and Simpkins, 1977], [Grousson and Mallic,
 1977], which was originally developed for application in the field of solid
 mechanics.
 They demonstrated how to measure the fluid velocity field by measuring
 the parabolic velocity profile for a laminar flow in a tube, by using a
 double exposure photographs in combination with laser illuminated planar
 light sheet and interrogation by forming Young's interference fringes from
 multiple pairs of displaced laser speckles in small interrogation spots
 on the specklegrams.
 
\end_layout

\begin_layout Standard
A young phd student [Meynart, 1979-1983] showed many practical applications
 in both laminar and turbulent fluid flows by the method of LSV.
 This gained strong interest from the fluid mechanics community.
 In 1984, the first important explicit recognition of particle images was
 made in two contemporaneous papers by [Pickering and Halliwell, 1984],
 [Adrian, 1984], who argued that by illuminating fluid flows by light sheet
 would rarely if ever produce speckle patterns in the image plane.
 The image plane would instead have images of individual particles.
 This was the first time the term PIV was proposed in the literature with
 the purpose to distinguish it from LSV.
 A simple criterion was made to distinguish the occurrence of the one mode
 or the other by defining a dimensionless parameter called the source density,
 which basically is the mean number of particles in a volume of resolution,
 and one can express the number of overlapping images in the image plane
 in terms of it.
 Many turbulence researchers realized the promising ability PIV offered
 to study the structure of turbulent flows and this consequently strongly
 influenced in which direction PIV would be developed.
 Turbulence is characterized by its random chaotic motion making it impossible
 to determine the direction of the flow.
 Also the velocities and accelerations are high which implies to use very
 small particles, typically few microns in diameter in order to be able
 to follow these fluctuating acceleration.
 The tiny light scattering cross section of these particles suggest the
 use of high intensity illumination.
 To capture images of very fine particles without blurring required short
 exposure time and high intensity pulsed laser with a light sheet illuminating
 particles with diameter ranging from few microns in gases to tens of microns
 in liquids.
 
\end_layout

\begin_layout Standard
Many velocimetry techniques have been developed to characterize microfluidic
 systems with the order of micrometers or less in spatial resolutions.
 Two especially important techniques are micron-resolution Particle Image
 Velocimetry (
\begin_inset Formula $\mu$
\end_inset

PIV) and particle-tracking velocimetry (PTV).
 
\begin_inset Formula $\mu$
\end_inset

PIV is considered as independent from conventional macroscopic PIV or PTV
 methods, and is widely recognized as a reliable microfluidic velocimetry
 technique.
 Both 
\begin_inset Formula $\mu$
\end_inset

PIV and PTV techniques applies tracer particles suspended in the fluid,
 with a digital camera to acquire the displacement of suspended particles
 over time, but there are distinct differences between these two techniques.
 Particle displacement in PIV is determined by cross-correlation techniques
 for an interrogation region within an image pair where high particle densities
 are commonly a characteristic of PIV.
 With PTV, particle displacements are determined by typically tracking single
 particles with its nearest matching neighbor.
 To avoid particle misidentification, particle seeding densities are typically
 low with PTV techniques.
 For nanoscale fluid mechanics, PIV methods are more desirable due to the
 high particle seeding density and the avoidance of Brownian motion.
 
\end_layout

\begin_layout Standard
Extensive reviews of PTV and PIV techniques and its applications have been
 proposed by [Adrian, 1991, 1996, 2005], [Sinton, 2004], [Raffel et al.,
 2007] and [Lindken et al., 2009].
 Compared to macroscopic PIV, 
\begin_inset Formula $\mu$
\end_inset

PIV has considerably different mechanical and optical configurations.
 In order to enhance the signal and overcome diffraction effects caused
 by small particle size, typically 
\begin_inset Formula $<1\mu\textrm{m}$
\end_inset

, fluorescent imaging is typically used .
 By using a microscope equipped with proper optics, the resolution can be
 improved to less than one micrometer.
 Another distinct difference is that in 
\begin_inset Formula $\mu$
\end_inset

PIV, a volume illumination is used, while in macroscopic PIV a light sheet
 illumination is common.
\end_layout

\begin_layout Subsection
Experimental setup
\end_layout

\begin_layout Standard
The micro channel chip was manufactured in 
\begin_inset Formula $500\mu\textrm{m}$
\end_inset

 thick polished silicon wafer with 
\begin_inset Formula $6\,\textrm{inch}(15.24\textrm{cm})$
\end_inset

 in diameter.
 The structure of the micro-channels consisted of a rectangular cross-sections
 with a nominal depth of 
\begin_inset Formula $185\mu\textrm{m}$
\end_inset

 arranged in a Y-bifurcation layout, with the inflow from left to right.
 The width of the inlet was 
\begin_inset Formula $400\mu\textrm{m}$
\end_inset

 , while the smallest outlet was 
\begin_inset Formula $100\mu m$
\end_inset

 wide with an exit angle 
\begin_inset Formula $\alpha_{1}=45^{o}$
\end_inset

 relative to the inlet, and the second outlet with a width of 
\begin_inset Formula $400\mu m$
\end_inset

 with an exit angle 
\begin_inset Formula $\alpha_{2}=80^{o}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Wrap figure
lines 0
placement o
overhang 0col%
width "50col%"
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/ArtChip.png
	scale 16.5

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The base frame and the geometry of the silicon channel in a custom made
 which enables easy change of chip.
 The chip size with channel geometry is 20 × 40 mm.
 
\begin_inset CommandInset label
LatexCommand label
name "fig:ArtChip"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "kolaas2013visualization"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/ArtSetup.png
	scale 15

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Experimental setup showing flow generator, valves, channel geometry and
 outlet reservoir.
 The small outlets from the main channel can be used as pressure taps.
\begin_inset CommandInset label
LatexCommand label
name "fig:ArtSetup"

\end_inset


\begin_inset CommandInset citation
LatexCommand cite
key "kolaas2013visualization"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Microfluidic chip
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
A custom made frame where build to hold the silicon chip and to enable easy
 connection to other equipment and to quickly change the shape of the geometry
 fig 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ArtChip"

\end_inset

.
 The flow was driven by a programable syringe pump, not powerful enough
 to create a periodic time-dependent flow within the recording length of
 the camera.
 Alternatively, two valves were used to either send or bypass the flow through
 the bifurcation, where both outlets were connected through a confluence
 to ensure equal pressure condition on the outlets before ending in a pipe
 above a sink (atmospheric pressure condition).
\end_layout

\begin_layout Standard
As a light source for PTV and visualization, a metal halide lamp was used
 for fluorescence illumination of the particles, with power enough to capture
 at 1000 fps with a high speed video camera at a volume flow rate sufficiently
 for velocity measurement.
 At higher flow rates a pulsating light source was used to avoid streaks
 in the images acquired.
 For the recordings, a high speed video camera of CMOS type with maximum
 resolution of 
\begin_inset Formula $1024×1024$
\end_inset

 pixels at 
\begin_inset Formula $1000$
\end_inset

 fps and a pixel size of 
\begin_inset Formula $17\mu m$
\end_inset

 was used together with an motorized Olympus BX61 microscope, and a 
\begin_inset Formula $20×$
\end_inset

 magnification lens allowing to step the focus in the z-directions using
 microscope control software.
 
\end_layout

\begin_layout Standard
The flow was seeded with a invitrogen red fluorescent particles (F8851)
 
\begin_inset Formula $1\mu m$
\end_inset

 diluted with deionized water at the volume ratio 
\begin_inset Formula $1:1333$
\end_inset

 with a concentration of 
\begin_inset Formula $3.6\cdot10^{6}$
\end_inset

 particles/ ml.
 The highest flow rates was seeded with Duke scientific green fluorescent
 
\begin_inset Formula $4.8\mu m$
\end_inset

 (
\begin_inset Formula $5\mu m$
\end_inset

 nominal) particles (G0500) with a volume ratio of 
\begin_inset Formula $1:133$
\end_inset

 and a concentration of 
\begin_inset Formula $1.6\cdot10^{5}$
\end_inset

 particles/ml.
 
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Mathematical Models
\end_layout

\begin_layout Standard
The Navier-Stokes equations are the governing equations for viscous fluids
 in motion 
\begin_inset CommandInset citation
LatexCommand cite
key "white2006viscous,kundu2012fluid"

\end_inset

.
 These equations are systems of nonlinear partial differential equations
 and a statement of Newton’s second law, where the forces are modeled according
 to those in a viscous Newtonian fluid; stating that the sum of the inertial
 forces is equal to the sum of external forces.
 These equations dictates the velocity rather than the position.
 It follows that a solution of the Navier-Stokes is the velocity field.
 Once the velocity field is solved, other quantities may be found, such
 as flow rate, pressure, drag force and so on.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/illustratorPS/MatVol.eps
	scale 30

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Control volume
\begin_inset CommandInset label
LatexCommand label
name "fig:Control-volume"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the forthcoming sections we will derive the governing equations and formulate
 the boundary and initial conditions used in the experiment.
 Before deriving these equations, there are some important assumptions to
 be underlined.
 Firstly, the control volume we use to derive the equations is a moving
 control volume fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Control-volume"

\end_inset

), meaning that it will not experience momentum and flux through its boundaries.
 Second, we assume that all the fields of interest like velocity, pressure,
 temperature, and density are differentiable, 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
weakly at least
\end_layout

\end_inset

.
 By these assumptions the Reynolds transport theorem holds for an 
\begin_inset Formula $f$
\end_inset

 differentiable function defined as:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\int_{V(t)}f(\boldsymbol{x},t)dV(t)=\int_{V(t)}\frac{\partial}{\partial t}f(\boldsymbol{x},t)dV(t)+\int_{S(t)}f(\boldsymbol{x},t)\boldsymbol{u}\cdot\boldsymbol{n}dS\label{eq:RenoldsTransportTheorem}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{u}=(u,v,w)$
\end_inset

 is the velocity vector, 
\begin_inset Formula $\boldsymbol{n}=(n_{x},n_{y},n_{z})$
\end_inset

 is the normal vector, 
\begin_inset Formula $\boldsymbol{x}=(x,y,z)$
\end_inset

 the positional vector, 
\begin_inset Formula $V(t)$
\end_inset

 is the volume of the domain and 
\begin_inset Formula $S(t)$
\end_inset

 its surface.
 
\end_layout

\begin_layout Subsection
Conservation Of Mass: The Continuity Equation
\end_layout

\begin_layout Standard
Consider fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Control-volume"

\end_inset

) with density 
\begin_inset Formula $\rho$
\end_inset

.
 By mass conservation states that the total change of mass over some given
 time must be zero.
 
\begin_inset Formula 
\[
\frac{d}{dt}\int_{\Omega(t)}\rho d\Omega(t)=0
\]

\end_inset

By applying the Reynolds transport theorem we get
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{d}{dt}\int_{\Omega(t)}\rho d\Omega(t)=\int\frac{\partial}{\partial t}\rho d\Omega(t)+\int_{\partial\Omega(t)}\rho\boldsymbol{u}\cdot\boldsymbol{n}dS=0\label{eq:ReynoldsMass}
\end{equation}

\end_inset

We can now use Gauss theorem on the surface integral, which relates the
 outward flux of the vector field through the closed surface 
\begin_inset Formula $S$
\end_inset

 , to the volume integral of the divergence over the region inside the surface.
 In other words
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\int_{\partial\Omega(t)}\rho\boldsymbol{u}\cdot\boldsymbol{n}dS=\int_{\Omega(t)}\rho\nabla\cdot\boldsymbol{u}dV
\]

\end_inset

Substituting this into eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ReynoldsMass"

\end_inset

) we get the continuity equation in its general form:
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula 
\[
\int\frac{\partial\rho}{\partial t}+\rho\nabla\cdot\boldsymbol{u}dV(t)=0
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\Downarrow
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial\rho}{\partial t}+\rho\nabla\cdot\boldsymbol{u}dV(t)=0
\]

\end_inset

For fluids with constant density 
\begin_inset Formula $\rho$
\end_inset

, we end up with the continuity equation for an incompressible fluid
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\cdot\boldsymbol{u}=0\label{eq:ContinuityEquation}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Conservation Of Momentum: The Navier-Stokes Equation
\end_layout

\begin_layout Standard
We use the same principle for the derivation of the momentum equation.
 Newtons second law of motion states that the sum of external forces 
\begin_inset Formula $\boldsymbol{F}$
\end_inset

 acting on an object is equal to the product of its mass 
\begin_inset Formula $m$
\end_inset

 and its acceleration
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Note that both the sum of external forces 
\begin_inset Formula $\boldsymbol{F}$
\end_inset

 and acceleration 
\begin_inset Formula $\boldsymbol{a}$
\end_inset

 is a vector sum.
 Any bold notation hereafter indicates that we are dealing with a vector,
 unless something else is spesified.
\end_layout

\end_inset

 : 
\begin_inset Formula $\sum\boldsymbol{F}=m\boldsymbol{a}.$
\end_inset

 In terms of time derivative we get
\begin_inset Formula 
\[
\sum\boldsymbol{F}=\frac{d}{dt}\int_{\Omega(t)}\rho\boldsymbol{u}d\Omega(t)
\]

\end_inset

Now we can apply the Reynolds transport theorem on the latter equation and
 perform integration by parts on the surface integral.
 We also apply the Gauss theorem to relate the surface integral to the volume
 integral.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\frac{d}{dt}\int_{\Omega(t)}\rho\boldsymbol{u}d\Omega(t) & = & \int_{\Omega(t)}\frac{\partial(\rho\boldsymbol{u})}{\partial t}d\Omega(t)+\int_{\partial\Omega(t)}(\boldsymbol{u}\cdot\boldsymbol{n})\rho\boldsymbol{u}dS\nonumber \\
 & = & \int_{\Omega(t)}\frac{\partial(\rho\boldsymbol{u})}{\partial t}d\Omega(t)+\int_{\Omega(t)}\rho\boldsymbol{u}\cdot\nabla\boldsymbol{u}+\rho(\nabla\cdot\boldsymbol{u})\boldsymbol{u}d\Omega(t)\nonumber \\
 & = & \int_{V(t)}\rho\frac{\partial\boldsymbol{u}}{\partial t}+\rho\boldsymbol{u}\cdot\nabla\boldsymbol{u}dV(t)\label{eq:ReynoldsLhsNS}
\end{eqnarray}

\end_inset

where the continuity equation is used 
\begin_inset Formula $\nabla\cdot\boldsymbol{u}=0$
\end_inset

 on the last term.
 The latter equation is only the inertial part of the momentum equation.
 The inertial forces must be equal to the external forces acting on the
 fluid, which includes the viscous forces 
\begin_inset Formula $\sigma(\boldsymbol{u},p)=2\mu\epsilon(\boldsymbol{u})-pI$
\end_inset

 and body forces 
\begin_inset Formula $\boldsymbol{f}$
\end_inset

 e.g gravity.
 The strain tensor is defined as 
\begin_inset Formula $\epsilon(\boldsymbol{u})=\frac{1}{2}(\nabla\boldsymbol{u}+\nabla\boldsymbol{u}^{T})$
\end_inset

.
 
\begin_inset Formula 
\[
\sum\boldsymbol{F}=\int_{\Omega(t)}\boldsymbol{f}d\Omega+\int_{\partial\Omega(t)}\sigma\cdot\boldsymbol{n}dS
\]

\end_inset

Again we use the Gauss theorem to get
\begin_inset Formula 
\begin{equation}
\sum\boldsymbol{F}=\int_{\Omega(t)}\boldsymbol{f}+2\mu\epsilon(\boldsymbol{u})-\nabla pdV(t)\label{eq:rhsReynoldsNS}
\end{equation}

\end_inset

With eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ReynoldsLhsNS"

\end_inset

) equals to eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:rhsReynoldsNS"

\end_inset

) we get the Navier-Stokes equation for an incompressible fluid
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\boldsymbol{u}}{\partial t}+(\boldsymbol{u}\cdot\nabla)\boldsymbol{u}=-\nabla p+\nu\nabla^{2}\boldsymbol{u}+\boldsymbol{f}\label{eq:NavierStoke}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The continuity equation eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ContinuityEquation"

\end_inset

) and the Navier-Stokes equation eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:NavierStoke"

\end_inset

) are commonly referred to as the the Navier-Stokes equations 
\begin_inset CommandInset citation
LatexCommand cite
key "langtangen2002numerical"

\end_inset

, and will hereafter be termed according to this terminology.
\end_layout

\begin_layout Subsection
Boundary and Initial Conditions
\end_layout

\begin_layout Standard
The initial conditions prescribes the initial state of the velocity 
\begin_inset Formula $\boldsymbol{u}$
\end_inset

 which will soon be covered, while the boundary conditions may be of several
 types.
 
\end_layout

\begin_layout Subsubsection
Boundary Conditions
\end_layout

\begin_layout Standard
There are three common choices of boundary conditions and can generally
 be stated as follows:
\end_layout

\begin_layout Itemize
Dirichlet condition: prescribed velocity components
\begin_inset Formula 
\begin{equation}
\mathcal{B}_{i}=u-g\label{eq:Dirichlet}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Neumann condition: vanishing normal derivatives of the velocity components
\begin_inset Formula 
\begin{equation}
\mathcal{B}_{i}=-\alpha\frac{du}{dx}-g\label{eq:Neumann}
\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Robin condition: prescribed stress vector components
\begin_inset Formula 
\begin{equation}
\mathcal{B}_{i}=-\alpha\frac{du}{dx}-H(u-g)\label{eq:Robin}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
where 
\begin_inset Formula $H$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 are quantities to be specified.
 The Dirichlet condition eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Dirichlet"

\end_inset

) specifies a value for the velocity, say 
\begin_inset Formula $u(0,t)=u(L,t)=A$
\end_inset

 or a known variation 
\begin_inset Formula $u_{x}(L,t)=B$
\end_inset

 for all 
\begin_inset Formula $t$
\end_inset

.
 For a no-slip condition 
\begin_inset Formula $A=0$
\end_inset

.
 The Neumann condition specifies the normal vector or the flux out of the
 boundary 
\begin_inset Formula $\frac{\partial u}{\partial n}=\boldsymbol{n}\cdot\nabla u$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "HPLWave"

\end_inset

.
 If 
\begin_inset Formula $\frac{\partial u}{\partial n}=0$
\end_inset

 we have a homogenous Neumann condition which basically is a Dirichlet condition.
 The above mentioned BC's can also be combined in a way that suits a problem
 specific boundary condition where also the pressure may be involved.
 This combination will be one of the major topics this thesis.
\end_layout

\begin_layout Paragraph
Resistance Boundary Condition (RBC)
\end_layout

\begin_layout Standard
The easiest way to model the outflow would be to apply a zero traction boundary
 condition at the outlets 
\begin_inset CommandInset citation
LatexCommand cite
key "logg2012automated"

\end_inset

.
 However, in a bifurcation the flow division is only dependent on the downstream
 flow, and the zero traction condition does not capture this very well.
 This type of BC is reasonable for simulations of flows in a domain with
 a single outlet but also for steady flow simulations with multiple outlets,
 given that the pressure at each outlet is known from measurements 
\begin_inset CommandInset citation
LatexCommand cite
key "grinberg2008outflow"

\end_inset

.
 In unsteady flow simulations with multiple junctions, fixing the pressure
 at the outlets provides physiologically incorrect results.
 Since the details of the velocity and the pressure from the experiment
 are not known, we may model the pressure at the outlets by resistance boundary
 condition (RBC) in conjunction with Neumann condition for the velocity.
 The value of the RBC is proportional to the flow, we may therefor model
 the pressure at the outlet 
\begin_inset Formula $\Gamma_{out,i}$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
p_{i}=p_{0}+R=p_{0}+C\int u_{i}\cdot\boldsymbol{n}\textrm{ds}_{i}\label{eq:RBC}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
p_{out1} & = & p_{0}+C\int u\cdot\boldsymbol{n}\textrm{ds}_{1}\label{eq:RBC2}\\
p_{out2} & = & p_{0}+C\int u\cdot\boldsymbol{n}\textrm{ds}_{2}\label{eq:RBC3}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
Where 
\begin_inset Formula $p_{0}$
\end_inset

 is the mean intracranial arterial pressure 
\begin_inset Formula $(85\textrm{mmHg})$
\end_inset

, 
\begin_inset Formula $C$
\end_inset

 is the resistance coefficient, 
\begin_inset Formula $u$
\end_inset

 is the velocity, 
\begin_inset Formula $\boldsymbol{n}$
\end_inset

 is the outwards normal vector and 
\begin_inset Formula $\textrm{ds}_{i}$
\end_inset

 is the length or the area of the outlets.
 
\begin_inset Formula $C$
\end_inset

 is usually taken according to a table and depends on the peripheral of
 the arteries.
 From eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:RBC"

\end_inset

) we recognize that the RBC is based on the assumption of linear dependency
 between the pressure and the velocity at each outlet.
 Application of RBC in rigid walled domains may cause numerical instabilities
 because the velocity fluctuations at all frequencies are transferred to
 the pressure oscillations.
 The RBC in this form eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:RBC"

\end_inset

) is a model used in computational hemodynamics e.g blood flow in arteries.
 However, since we are trying to emulate an experiment where the fluid is
 water seeded with tiny particles, we may modify this equation in a way
 that is appropriate to the experiment.
 In the numerical section, we will go much deeper into how the RBC behaves.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
One must be aware of phase shifting in pressure waves at the outlets.
\end_layout

\begin_layout Plain Layout
RBC has its origin from electrical circuits governed by Ohm's law
\begin_inset Formula 
\[
V=IR
\]

\end_inset

where 
\begin_inset Formula $I$
\end_inset

 is the current through the conductor in units of amperes, V is the potential
 difference measured across the conductor in units of volts, and R is the
 resistance of the conductor in units of ohms.
 More specifically, Ohm's law states that the R in this relation is constant,
 independent of the curren
\end_layout

\begin_layout Plain Layout
From a computational point of view, prescribing a constant pressure at each
 outlet is the least complicated.
\end_layout

\begin_layout Plain Layout
\begin_inset Wrap figure
lines 0
placement o
overhang 0col%
width "50col%"
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/div/120px-OhmsLaw.svg.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Initial Conditions
\end_layout

\begin_layout Standard
In the experiment, both stationary and pulsatile flows was generated.
 For the stationary case a fully developed Poiseuille flow will be used
 at the inlet, eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VelocityProfile2D"

\end_inset

) in 2D and eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VelocityProfile3D"

\end_inset

) in 3D, which will be clarified soon, but first we will investigate in
 the pulsatile initial condition.
\end_layout

\begin_layout Standard
For the pulsatile flow a dimensionless number called the Womersley number
 will be used.
 This number relates the transient forces to viscous forces
\begin_inset Formula 
\[
\alpha^{2}=\frac{\textrm{transient}}{\textrm{viscous}}=\frac{\omega U}{\nu U/L^{2}}=\frac{\omega L^{2}}{\nu}=\frac{\omega D_{h}^{2}}{\nu}
\]

\end_inset

where 
\begin_inset Formula $\nu$
\end_inset

 is the kinematic viscosity, 
\begin_inset Formula $D_{h}$
\end_inset

 the hydraulic diameter defined as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
D_{h}=\frac{2ab}{a+b}=\frac{2\cdot400\cdot185}{400+185}=253\mu m\label{eq:HydraulicDiameter}
\end{equation}

\end_inset

The angular frequency 
\begin_inset Formula $\omega$
\end_inset

expressed in terms of microhertz 
\begin_inset Formula 
\begin{equation}
\omega=\frac{2\pi}{T}=2\pi f\label{eq:AngularFrequency}
\end{equation}

\end_inset

In the experiment two different frequencies 
\begin_inset Formula $f$
\end_inset

 where used
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\alpha_{1\mu Hz}=D_{h}\sqrt{\frac{\omega}{\nu}}=253\sqrt{\frac{2\pi\cdot1\mu\textrm{Hz}}{1.004\frac{\mu\textrm{m}^{2}}{\mu\textrm{s}}}}=0.633
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\alpha_{2\mu Hz}=D_{h}\sqrt{\frac{\omega}{\nu}}=253\sqrt{\frac{2\pi\cdot2\mu\textrm{Hz}}{1.004\frac{\mu\textrm{m}^{2}}{\mu\textrm{s}}}}=0.895
\]

\end_inset

It turns out that when 
\begin_inset Formula $\alpha<1$
\end_inset

, the flow predicts the pressure gradients very well and exhibit a parabolic
 shape such that the oscillating fluid has the largest amplitude farthest
 away from the wall, which is characterized as a 
\emph on
quasi-steady
\emph default
 behavior 
\begin_inset CommandInset citation
LatexCommand cite
key "loudon1998use"

\end_inset

.
 With 
\begin_inset Formula $\alpha>1$
\end_inset

 the velocity profile is no longer parabolic and the flow is phase-shifted
 relative to the oscillating pressure gradients and the amplitude of the
 fluid may either decrease or increase.
 
\end_layout

\begin_layout Standard
Consider a periodic pressure gradient on the form 
\begin_inset Formula 
\[
\frac{\partial p}{\partial x}=-A\textrm{e}^{i\omega t}=-A\left(\cos(\omega t)+i\sin(\omega t)\right)
\]

\end_inset

where the frequency is defined in eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:AngularFrequency"

\end_inset

), the constant 
\begin_inset Formula $A$
\end_inset

 is real and 
\begin_inset Formula $i=\sqrt{-1}$
\end_inset

.
 The solution for the velocity field in this case in complex form is given
 as
\begin_inset Formula 
\begin{equation}
u(y,t)=\frac{A}{i\omega\rho}\left[1-\frac{\cosh\left(\frac{\alpha y\sqrt{i}}{a}\right)}{\cosh\left(\alpha\sqrt{i}\right)}\right]\textrm{e}^{i\omega t}\label{eq:VelocityProfileComplex}
\end{equation}

\end_inset

We must discard the imaginary components and solve for the real part, where
 the real part of eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:VelocityProfileComplex"

\end_inset

) is 
\begin_inset Formula 
\begin{eqnarray}
u(y,t) & = & \frac{A}{i\omega\gamma}\{[\sinh\boldsymbol{\Phi}_{1}(y)\sin\boldsymbol{\Phi}_{2}(y)\nonumber \\
 &  & +\sinh\boldsymbol{\Phi}_{2}(y)\sin\boldsymbol{\Phi}_{1}(y)]\cos(\omega t)\label{eq:VelocityProfileReal}\\
 &  & +[\gamma-\cosh\boldsymbol{\Phi}_{1}(y)\cos\boldsymbol{\Phi}_{2}(y)\nonumber \\
 &  & -\cosh\boldsymbol{\Phi}_{2}(y)\cos\boldsymbol{\Phi}_{1}(y)]\sin(\omega t)\}\nonumber 
\end{eqnarray}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
\boldsymbol{\Phi}_{1}(y)=\frac{\alpha}{\sqrt{2}}\left(1+\frac{y}{a}\right),\qquad\boldsymbol{\Phi}_{2}(y)=\frac{\alpha}{\sqrt{2}}\left(1-\frac{y}{a}\right)\label{eq:PhiBold}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\gamma=\cosh\left(\alpha\sqrt{2}\right)+\cos\left(\alpha\sqrt{2}\right)\label{eq:gammaReal}
\end{equation}

\end_inset

The amplitude 
\begin_inset Formula $u_{max}$
\end_inset

 for this oscillating velocity is
\begin_inset Formula 
\begin{eqnarray*}
u_{max} & = & \frac{A}{i\omega\rho}\{[\sinh\boldsymbol{\Phi}_{1}(y)\sin\boldsymbol{\Phi}_{2}(y)+\sinh\boldsymbol{\Phi}_{2}(y)\sin\boldsymbol{\Phi}_{1}(y)]^{2}\\
 &  & +[\gamma-\cosh\boldsymbol{\Phi}_{1}(y)\cos\boldsymbol{\Phi}_{2}(y)-\cosh\boldsymbol{\Phi}_{2}(y)\cos\boldsymbol{\Phi}_{1}(y)]^{2}\}^{\frac{1}{2}}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Subsection
Poiseuille Flow 
\end_layout

\begin_layout Standard
A flow generated by a pressure gradient is called Poiseuille flow named
 after french physician J.L.M Poiseuille(1840) who experimented with laminar
 and steady flow in tubes.
 When the flow is settled as we get far enough from its entrance, the velocity
 becomes axial and varies only with the lateral axis, and the flow is then
 called fully developed 
\begin_inset CommandInset citation
LatexCommand cite
key "white2006viscous"

\end_inset

.
 This means that 
\begin_inset Formula $u=u(y,z)$
\end_inset

, 
\begin_inset Formula $v=w=0$
\end_inset

, and 
\begin_inset Formula $\frac{\partial}{\partial x}=0$
\end_inset

.
 These conditions reduces the mass and momentum equations to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial u}{\partial x}=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
0=-\frac{dp}{dx}+\mu\left(\frac{\partial^{2}u}{\partial y^{2}}+\frac{\partial^{2}u}{\partial z^{2}}\right)\label{eq:Poiseuille}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
0=-\frac{dp}{dy}=-\frac{dp}{dz}
\]

\end_inset

Indicating that the pressure is only a function of 
\begin_inset Formula $x$
\end_inset

 for the fully developed Poiseuille flow.
 
\end_layout

\begin_layout Subsubsection
2D Velocity Profile
\end_layout

\begin_layout Standard
In 2D we have that 
\begin_inset Formula $\frac{\partial u}{\partial z}=0$
\end_inset

, which reduces the momentum equation further to a Poisson equation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}u}{\partial y^{2}}=\frac{1}{\mu}\frac{dp}{dx}=\beta\label{eq:Poiseuille2D}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\beta$
\end_inset

 is a constant pressure gradient.
 By integrating the Laplacian term twice and apply the boundary conditions
 
\begin_inset Formula $u(y\pm h)=0$
\end_inset

, and optionally 
\begin_inset Formula $u(0)=u_{max}$
\end_inset

 we obtain an analytical solution for the problem in 2D.
 The latter boundary condition is strictly not necessary since we have a
 second order PDE in space, we only need two BC's to solve the PDE, but
 we will use it anyway to lump parameters and express the final solution
 in terms of 
\begin_inset Formula $u_{max}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{\partial u}{\partial y}=\beta y+A
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u(y)=\frac{1}{2}\beta y^{2}+Ay+B
\]

\end_inset


\end_layout

\begin_layout Standard
BC:
\begin_inset Formula 
\[
u(\pm h)=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u(h)=\frac{1}{2}\beta h^{2}+Ah+B=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u(-h)=\frac{1}{2}\beta h^{2}-Ah+B=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
A=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
B=-\frac{1}{2}\beta h^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u(0)=u_{max}=-\frac{1}{2}\beta h^{2}=-\frac{h^{2}}{2\mu_{d}}\frac{dp}{dx}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
u(y)=u_{maks}(1-\frac{y^{2}}{h^{2}})\label{eq:VelocityProfile2D}
\end{equation}

\end_inset

where 
\begin_inset Formula $h=200$
\end_inset

.
 This expression is as initial condition at the inflow for the 2D stationary
 simulation.
 The parabolic inflow profiles for different Re
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
\begin_inset Formula $\textrm{Re}=2.2$
\end_inset

 is exaggerated by 
\begin_inset Formula $10\times$
\end_inset

 , only to be visible in the plot.
 
\end_layout

\end_inset

 numbers are illustrated in fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Parabolic-velocity-profiles"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -1cm
\end_inset


\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/2Dparabolic.png
	scale 70

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Parabolic velocity profiles in 2D 
\begin_inset CommandInset label
LatexCommand label
name "fig:Parabolic-velocity-profiles"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
3D Velocity Profile
\end_layout

\begin_layout Standard
The analytical solution in 3D for a developed flow in a rectangular duct
 fig.?, is much more complicated.
 The problem will be solved by Fourier analysis and only cosine functions
 are involved, since they guarantee that the no-slip condition is fulfilled.
 We will Fourier expand in the 
\begin_inset Formula $y$
\end_inset

- direction such that 
\begin_inset Formula $u(\pm a,z)=0$
\end_inset

.
 Furthermore, we assume that the solution to the Navier-Stokes equation
 has the form 
\begin_inset Formula 
\begin{equation}
u(y,z)=\sum_{n=1}^{\infty}f_{n}(z)\cos(n\pi\frac{y}{2a})\label{eq:FourierNS}
\end{equation}

\end_inset

Substituting this equation into eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Poiseuille"

\end_inset

): 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial^{2}u}{\partial y^{2}}+\frac{\partial^{2}u}{\partial z^{2}} & = & \frac{dp}{\mu dx}\\
 & \Downarrow
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sum_{n=1}^{\infty}\left[\frac{\partial^{2}f_{n}(z)}{\partial z^{2}}-f_{n}(z)\left(\frac{n\pi}{2a}\right)^{2}\right]\cos(n\pi\frac{y}{2a})=\frac{dp}{\mu dx}
\]

\end_inset

We also need to Fourier transform the constant 
\begin_inset Formula $\frac{dp}{\mu dx}$
\end_inset

, or simpler, just the constant 
\begin_inset Formula $1$
\end_inset

 that can be multiplied by any constant.
 
\begin_inset Formula 
\[
\frac{dp}{\mu dx}=\frac{dp}{\mu dx}\times1=\frac{dp}{\mu dx}\frac{4}{\pi}\sum_{n,odd}^{\infty}\frac{1}{n}\cos(n\pi\frac{y}{2a})
\]

\end_inset

The solution is valid only if
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)=0\qquad\textrm{for n even}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial^{2}f_{n}(z)}{\partial z^{2}}-f_{n}(z)\left(\frac{n\pi}{2a}\right)^{2}=\frac{dp}{\mu dx}\frac{4}{n\pi}\qquad\textrm{for n odd}\label{eq:NonHomo}
\end{equation}

\end_inset

Now we have a non-homogenous solution with 
\begin_inset Formula $f_{n}(z)_{h}$
\end_inset

 homogenous and 
\begin_inset Formula $f_{n}(z)_{p}$
\end_inset

 the particular solution: 
\begin_inset Formula 
\begin{equation}
f_{n}(z)=f_{n}(z)_{h}+f_{n}(z)_{p}\label{eq:GenNonHomo}
\end{equation}

\end_inset

First we seek a general solution of the homogenous term 
\begin_inset Formula $f_{n}(z)_{h}$
\end_inset

.
 The characteristic solution of this is 
\begin_inset Formula 
\[
\lambda^{2}-\left(\frac{n\pi}{2a}\right)^{2}\lambda=0
\]

\end_inset

with roots 
\begin_inset Formula $\lambda_{1}=0$
\end_inset

 and 
\begin_inset Formula $\lambda_{2}=\frac{n\pi}{2a}$
\end_inset

, which leads to the real general solution of the homogenous equation 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)_{h}=A\textrm{e}^{z\lambda_{1}}+B\textrm{e}^{z\lambda_{2}}
\]

\end_inset

By using the definition of hyperbolic functions
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sinh(z)=\frac{\textrm{e}^{z}-\textrm{e}^{-z}}{2}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\cosh(z)=\frac{\textrm{e}^{z}+\textrm{e}^{-z}}{2}
\]

\end_inset

the general solution of the homogenous term can be rewritten as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)_{h}=A\sinh(\frac{n\pi z}{2a})+B\cosh(\frac{n\pi z}{2a})
\]

\end_inset

Next we want to find the particular solution 
\begin_inset Formula $f_{n}(z)_{p}$
\end_inset

 of the non-homogenous equation.
 The derivative of the right hand side is zero, we say that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)_{p}=C
\]

\end_inset

and substitute this in eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:NonHomo"

\end_inset

)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
0-\left(\frac{n\pi}{2a}\right)^{2}C & = & \frac{dp}{\mu dx}\frac{4}{n\pi}\\
C & = & \frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}
\end{eqnarray*}

\end_inset

The general solution of the non-homogenous equation eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GenNonHomo"

\end_inset

)is thus
\begin_inset Formula 
\[
f_{n}(z)=A\sinh(\frac{n\pi z}{2a})+B\cosh(\frac{n\pi z}{2a})-\frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}
\]

\end_inset

Now we can use the no-slip condition 
\begin_inset Formula $u(\pm b)=0$
\end_inset

.
 
\begin_inset Formula $A\overset{!}{=}0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)_{p}=B\cosh(\frac{n\pi b}{2a})-\frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
B=\frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}\frac{1}{\cosh(\frac{n\pi b}{2a})}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{n}(z)=\frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}\frac{\cosh(\frac{n\pi z}{2a})}{\cosh(\frac{n\pi b}{2a})}-\frac{dp}{\mu dx}\frac{16a^{2}}{n^{3}\pi^{3}}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
f_{n}(z)=\frac{dp}{dx}\frac{16a^{2}}{n^{3}\pi^{3}\mu}\left[\frac{\cosh(\frac{n\pi z}{2a})}{\cosh(\frac{n\pi b}{2a})}-1\right]\label{eq:fnFourier}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Substituting eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:fnFourier"

\end_inset

) into eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:FourierNS"

\end_inset

) 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
u(y,z)=\frac{dp}{dx}\frac{16a^{2}}{\pi^{3}\mu}\sum_{n=1,3...,k+1}^{\infty}\left[\frac{\cosh(\frac{n\pi z}{2a})}{\cosh(\frac{n\pi b}{2a})}-1\right]\times\frac{\cos(\frac{n\pi y}{2a})}{n^{3}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Changing the notation 
\begin_inset Formula $n=i$
\end_inset

, we end with the expression for a fully developed flow in 3D.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
(
\begin_inset Formula $a=200\mu m$
\end_inset

), (
\begin_inset Formula $b=92.5\mu m)$
\end_inset

, 
\begin_inset Formula $-a\leq y\leq a$
\end_inset

, 
\begin_inset Formula $-b\leq z\leq b$
\end_inset

, 
\end_layout

\begin_layout Standard
Velocity profile
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
u(y,z)=\frac{16a^{2}}{\mu_{d}\pi^{3}}\left(-\frac{d\hat{p}}{dx}\right)\sum_{i=1,3,\ldots n+1}^{\infty}(-1)^{\frac{i-1}{2}}\left[1-\frac{\cosh(\frac{i\pi z}{2a})}{\cosh(\frac{i\pi b}{2a})}\right]\times\frac{\cos\left(\frac{i\pi y}{2a}\right)}{i^{3}}\label{eq:VelocityProfile3D}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Volume flow rate
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Q=\frac{4ba^{3}}{3\mu}\left(-\frac{d\hat{p}}{dx}\right)\left[1-\frac{192a}{\pi^{5}b}\sum_{i=1,3,\ldots n+1}^{\infty}\frac{\tanh(\frac{i\pi b}{2a})}{i^{5}}\right]
\]

\end_inset


\end_layout

\begin_layout Standard
Mean velocity
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\bar{u}=\frac{Q}{A}
\]

\end_inset

The velocity profile in 3D fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Parabolic-velocity-profile3D"

\end_inset

) is implemented by 
\begin_inset CommandInset citation
LatexCommand cite
key "Mortensen2013MEK4300"

\end_inset

 in C++ , which is a much faster code than the corresponding python code.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/3Dparabolic.eps
	scale 70

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Parabolic velocity profile in 3D (unity)
\begin_inset CommandInset label
LatexCommand label
name "fig:Parabolic-velocity-profile3D"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Re$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $u_{max}[\frac{\mu m}{\mu s}]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\overline{u}[\frac{\mu m}{\mu s}]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Q[\frac{\mu m^{3}}{\mu s}]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.008730$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.00582$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $431$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $84$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.333343$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.2222287$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $16444$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $110$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.436521$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.291014$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $21535$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $170$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.674624$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.4497493$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $33281$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $220$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.873043$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.5820287$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $43070$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $340$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.349249$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.899499$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $66563$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Kinematics
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
U=\frac{Re\cdot\nu}{D_{h}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Q=\overline{u}\cdot A
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\bar{u}=\frac{Q}{l}
\]

\end_inset


\end_layout

\begin_layout Subsection
Summary
\end_layout

\begin_layout Standard
Summarizing the finale model mathematical 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial\boldsymbol{u}}{\partial t}+(\boldsymbol{u}\cdot\nabla)\boldsymbol{u} & = & -\nabla p+\nu\nabla^{2}\boldsymbol{u}+\boldsymbol{f}\qquad\textrm{for}\qquad\boldsymbol{x}\in\Omega\\
\nabla\cdot\boldsymbol{u} & = & 0\qquad\textrm{for}\qquad\boldsymbol{x}\in\Omega\times[0,T]\\
\boldsymbol{u}(\boldsymbol{x},t) & = & 0\qquad\textrm{for}\qquad\boldsymbol{x}\in\Gamma\times[0,T]\\
p_{i} & = & p_{0}+C\int u_{i}\cdot\boldsymbol{n}\textrm{ds}_{i}\qquad\textrm{for}\qquad\boldsymbol{x}\in\Gamma_{out1}\quad\mbox{and}\quad\boldsymbol{x}\in\Gamma_{out2}\\
\boldsymbol{u}(\boldsymbol{x},0) & = & u_{0}\qquad\textrm{for}\qquad\boldsymbol{x}\in\Gamma_{in}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula $p_{i}=p_{0}+R=p_{0}+C\int u_{i}\cdot\boldsymbol{n}\textrm{ds}_{i}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Formula 
\[
\begin{array}{ccccc}
x\\
 & c
\end{array}\}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\left.\frac{\partial\boldsymbol{u}}{\partial t}+(\boldsymbol{u}\cdot\nabla)\boldsymbol{u}\right\} 
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{eqnarray*}
\frac{\partial\boldsymbol{u}}{\partial t}+(\boldsymbol{u}\cdot\nabla)\boldsymbol{u} & = & -\nabla p+\nu\nabla^{2}\boldsymbol{u}+\boldsymbol{f}\\
\nabla\cdot\boldsymbol{u} & = & 0
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\boldsymbol{n}\cdot\nabla u=\frac{\partial u}{\partial n}\qquad\textrm{for}\qquad\boldsymbol{x}\in\Gamma_{out1}\quad\mbox{and}\quad\boldsymbol{x}\in\Gamma_{out2}
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "103col%"
special "none"
height "0.95in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/illustratorPS/biGmshTex.eps
	scale 50

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The bifurcation domain with initial and boundary conditions
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Numerical Method
\end_layout

\begin_layout Standard
There are many numerical techniques for finding approximate solutions to
 partial differential equations with initial and boundary value problems
 e.g the Navier-Stokes equations.
 Some more efficient than others.
 One especially popular technique is to spatially discretize the Navier-Stokes
 equations by the finite element method (FEM)
\begin_inset CommandInset citation
LatexCommand cite
key "HPL2015FuncApprox"

\end_inset

, and discretize the temporal domain by the finite difference method.
 In the next following sections we will briefly go through the numerical
 methods used in this thesis.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Preconditioners are useful in iterative methods to solve a linear system
 Ax=b for x since the rate of convergence for most iterative linear solvers
 increases as the condition number of a matrix decreases as a result of
 preconditioning.
 Preconditioned iterative solvers typically outperform direct solvers, e.g.,
 Gaussian elimination, for large, especially for sparse, matrices.
 Iterative solvers can be used as matrix-free methods, i.e.
 become the only choice if the coefficient matrix A is not stored explicitly,
 but is accessed by evaluating matrix-vector products.
 wiki
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Kirkpatrick:
\end_layout

\begin_layout Plain Layout
Fractional step projection methods integrate the Navier–Stokes equations
 in time at each time step by first solving the momentum equations using
 an approximate pressure field to yield an intermediate velocity field that
 will not, in general, satisfy conservation of mass.
 A Poisson equation is then solved with the divergence of the intermediate
 velocity as a source term to provide a pressure or pressure correction,
 which is then used to correct the intermediate velocity field, providing
 a divergence free velocity field.
 The pressure is updated and integration then proceeds to the next time
 step.
 An extensive list of references for various fractional step methods developed
 for the Navier–Stokes equations is given by Armfield and Street
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
fjnrfnrjl jrnejl
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Finite Element Method (FEM)
\end_layout

\begin_layout Standard
FEM was initially developed for strain-stress calculations in solid mechanics
 where the mathematical foundation was based on variational interpretation
 of the total potential energy of the system 
\begin_inset CommandInset citation
LatexCommand cite
key "kundu2012fluid"

\end_inset

.
 Some of the major strengths of FEM is its ability to easily deal with complex
 geometries and unstructured meshes, and also higher order approximations
 of the solutions 
\begin_inset CommandInset citation
LatexCommand cite
key "HPL2015FuncApprox"

\end_inset

..
 The main idea of FEM is to divide the domain into elements typically shaped
 as tetrahedrons in 3D or triangles in 2D, and approximate the unknown function
 by piecewise polynomials on each element.
 These piecewise approximations are then glued together at the vertices
 to find a global solution The chosen polynomials can be linear or quadratic,
 but in terms of computational efficiency, higher order polynomials are
 desirable.
 The error of the polynomial approximations is proportional to 
\begin_inset Formula $h^{d+1}$
\end_inset

, where 
\begin_inset Formula $h$
\end_inset

 is the length of the element and 
\begin_inset Formula $d$
\end_inset

 is the degree of the polynomial 
\begin_inset CommandInset citation
LatexCommand cite
key "HPL2015StVar"

\end_inset

.
 In most CFD problems, the Galerkin formulation of FEM is used, on which
 will be the main focus in this section.
 
\end_layout

\begin_layout Standard
The fundamental idea in solving PDE's in FEM is to seek an approximate solution
 
\begin_inset Formula $u$
\end_inset

 in some function space 
\begin_inset Formula $V$
\end_inset

, such that any 
\begin_inset Formula $u\in V$
\end_inset

 can be expressed as a linear combination of some prescribed finite element
 basis functions 
\begin_inset Formula $\{\psi_{j}\}_{j\in\mathcal{I}_{s}}$
\end_inset

 where 
\begin_inset Formula $\mathcal{I}_{s}=\{0,...,N\}$
\end_inset

:
\end_layout

\begin_layout Standard

\lang norsk
\begin_inset Formula 
\begin{equation}
u(x)=\sum_{j\in\mathcal{I}_{s}}c_{j}\psi_{j}(x)\label{eq:ApproxBasisV}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\lang norsk
\begin_inset Formula 
\begin{equation}
V=\textrm{span}\{\psi_{j}(x)\}\label{eq:Vspan}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Consider an abstract PDE 
\begin_inset Formula $\mathcal{L}(u)=f$
\end_inset

, where a residual 
\begin_inset Formula $R$
\end_inset

 is formed to measure the error in fulfilling the governing equation.
\begin_inset Formula 
\begin{equation}
R=\mathcal{L}(u)=\mathcal{L}\left(\sum_{j\in\mathcal{I}_{s}}c_{j}\psi_{j}(x)\right)\label{eq:R}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The idea of the Galerkin method is to minimize this residual by demanding
 
\begin_inset Formula $R$
\end_inset

 to be orthogonal to some space 
\begin_inset Formula $W$
\end_inset

, not necessarily in the same space as 
\begin_inset Formula $V$
\end_inset

 where we seek the unknown function.
 This generalization is popularly called the method of weighted residuals.
 
\begin_inset Formula 
\begin{equation}
(R,v)=0,\qquad\forall v\in W\label{eq:GalerkinW}
\end{equation}

\end_inset

Now, if 
\begin_inset Formula $\{w_{0},...,w_{N}\}$
\end_inset

 is a basis for 
\begin_inset Formula $W$
\end_inset

, we may equivalently express the method of wighted residual as
\begin_inset Formula 
\begin{equation}
(R,w_{i})=0,\qquad i\in\mathcal{I}_{s}\label{eq:GalerkinI}
\end{equation}

\end_inset

Which results in 
\begin_inset Formula $N+1$
\end_inset

 equations for 
\begin_inset Formula $\{c_{i}\}_{i\in\mathcal{I}_{s}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
Statements like eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GalerkinW"

\end_inset

) and eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GalerkinI"

\end_inset

) are known as variational formulations or weak formulations, while the
 continuity eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ContinuityEquation"

\end_inset

) and the Navier-Stokes equations eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:NavierStoke"

\end_inset

) in this form are called 
\emph on
strong
\emph default
 or 
\emph on
classical 
\emph default
formulations of the problem.
 In the variational formulations it is common to use the name trial function
 for the approximate 
\begin_inset Formula $u=\sum_{j}c_{j}\psi_{j}$
\end_inset

, and the space 
\begin_inset Formula $V$
\end_inset

 containing the trial function is called trial space.
 The function 
\begin_inset Formula $v$
\end_inset

 or 
\begin_inset Formula $w_{i}$
\end_inset

 entering the orthogonality requirement is termed as test functions, and
 the space 
\begin_inset Formula $W$
\end_inset

 containing the test functions is called test space.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
FEM tutorial: 
\end_layout

\begin_layout Plain Layout
Reformulate the PDE problem as a variational problem
\end_layout

\begin_layout Plain Layout
MEK4300
\end_layout

\begin_layout Plain Layout
The variational problem is solved by creating a Function to hold the solution
 and then calling the function solve.
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Summary
\end_layout

\begin_layout Standard
The Galerkin method can be briefly summarized by the following four steps:
 
\end_layout

\begin_layout Enumerate
PDE: 
\begin_inset Formula $\mathcal{A}u=f$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Multiply by a test function 
\begin_inset Formula $v$
\end_inset

, which turns the PDE into
\end_layout

\end_deeper
\begin_layout Enumerate
Continuous variational problem: 
\begin_inset Formula $a(u,v)=L(v)$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Take 
\begin_inset Formula $V_{h}\subset V$
\end_inset

: to get
\end_layout

\end_deeper
\begin_layout Enumerate
Discrete variational problem: 
\begin_inset Formula $a(u_{h},v)=L(v)$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Approximatin 
\begin_inset Formula $u$
\end_inset

 by 
\begin_inset Formula $u_{h}=\sum_{j}U_{j}\phi_{j}$
\end_inset

, leads to 
\end_layout

\end_deeper
\begin_layout Enumerate
System of discrete equations: 
\begin_inset Formula $AU=b$
\end_inset

 
\end_layout

\begin_layout Subsection
Mesh
\end_layout

\begin_layout Standard
The meshes was created in gmsh - an open source finite element mesh generator.
 Several versions of each geometries was created with different resolution.
 This to verify the implementations, but also to investigate in the strengths
 and challenges associated with DNS in terms of mesh resolution.
 Relevant information of some of the meshes to be discussed are given in
 table
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Mesh-info"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="8">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Mesh
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F an3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C an3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F bi3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C bi3D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
F an2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
C an2D
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
bi2D
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Cells
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
330966
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
44770
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
130027
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
18578
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13851
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3294
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6383
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Vertices
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
61023
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9461
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
25686
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4357
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7111
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1733
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3333
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h_{max}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
54.6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
110.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
56.4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
102
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
29
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
34.6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $h_{min}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10.7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
22.3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7.5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15.8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8.4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Mesh info: Fine and Coarse
\begin_inset CommandInset label
LatexCommand label
name "tab:Mesh-info"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Fig.(
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Marking-the-boundaries"

\end_inset

) marks all the boundaries with the associated class names used in listing
 1, 2 and 3.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.5cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\noindent
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/inlet.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
inlet: 
\begin_inset Formula $u=u_{0}$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/outlet1.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
outlet1: 
\begin_inset Formula $\boldsymbol{n}\cdot\nabla u$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/outlet2.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
outlet2: 
\begin_inset Formula $\boldsymbol{n}\cdot\nabla u$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\paragraph_spacing single
\noindent
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/top.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
top: DBC 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/bottom.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
bottom: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/out1L.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
out1L: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/out1R.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
out1R: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/out2L.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
out2L: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/out2R.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
out2R: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align left
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/over.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
over: DBC 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/under.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
under: 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/anMark/an.png
	scale 25

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
an (aneurysm): 
\begin_inset Formula $u=0$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align left
\begin_inset Caption Standard

\begin_layout Plain Layout
Marking the boundaries applied in listing 1, 2 and 3
\begin_inset CommandInset label
LatexCommand label
name "fig:Marking-the-boundaries"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Subsection
Oasis
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Quotes eld
\end_inset

Since it is important for the efficiency of the constructed solver, the
 velocity vector u will be split up into its individual components uk
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Plain Layout
Implementation of the generic, unstructured Navier-Stokes solver in a low-level
 language like Fortran or C is a highly demanding and time consuming task,
 which could involve tens of thousands of lines exposed for errors and maintenan
ce.
 
\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Oasis is a high-performance unstructured Navier-Stokes solver written from
 scratch in Python, and uses building blocks from the FEniCS project - an
 automated differential equation solver based on FEM 
\begin_inset CommandInset citation
LatexCommand cite
key "mortensen2015oasis"

\end_inset

.
 In terms of performance, Oasis has the ability to compete with state of
 the art Navier-Stokes solvers written in low-level languages, like Fortran
 or C.
 In terms of ease of use and flexibility; one can easily change the discretizati
on scheme, or the type of the finite element in the command line interface.
 The user is only required to add a computational mesh in .xml file in a
 subfolder
\begin_inset Flex Code
status open

\begin_layout Plain Layout
Oasis/mesh
\end_layout

\end_inset

 , and make a main executable script in 
\begin_inset Flex Code
status open

\begin_layout Plain Layout
problems/NSfracstep
\end_layout

\end_inset

, with initial and boundary conditions, control parameters and optionally
 other user defined action.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Oasis is a high-performance unstructured Navier-Stokes solver written from
 scratch in Python, which uses building blocks from the FEniCS project -
 an automated differential equation solver based on FEM 
\begin_inset CommandInset citation
LatexCommand cite
key "mortensen2015oasis"

\end_inset

.
 In terms of performance, Oasis has the ability to compete with state of
 the art Navier-Stokes solvers written in low-level languages, like Fortran
 or C.
 It also has a highly versatile and ease of use interface; for instance,
 one can easily change the temporal discretization scheme, or the type of
 the finite element in the command line interface.
 The user is only required to add a computational mesh in a .xml file inserted
 in a subfolderOasis/mesh , and make a main executable script in Oasis/problems/
NSfracstep, with initial and boundary conditions, control parameters and
 optionally other user defined action.
 
\end_layout

\begin_layout Standard
The three dimensional Navier-Stokes equations are systems of 4 equations
 with 4 unknowns which may be solved all at once in a coupled manner at
 each tilmestep, or one by one by projection/splitting methods.
 The coupled method is regarded to be a stable and robust approach, but
 for large systems it requires much computational memory and iterative methods.
 In the fractional step method, the velocity vector are divided into its
 components 
\begin_inset Formula $u_{k}$
\end_inset

 which will increase the efficiency of the constructed solver.
 Oasis offers several splitting schemes, the chosen one and the default
 solver is the incremental pressure correction scheme (IPCS) in combination
 with Adams–Bashforth and Crank-Nicolson scheme (ABCN).
 The default solver in Oasis is thus logically termed IPCS_ABCN.
 Following the steps of
\begin_inset CommandInset citation
LatexCommand citep
key "mortensen2015oasis"

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Mortensen2015"

\end_inset

, a brief presentation of the schemes will be given in the next sections.
 
\end_layout

\begin_layout Subsection
Fractional Step Methods
\end_layout

\begin_layout Standard
The fractional step methods also referred to as projection methods, constitutes
 a popular approach for splitting the Navier-Stokes equations 
\begin_inset CommandInset citation
LatexCommand cite
key "guermond2006overview,langtangen2002numerical,Mortensen2015,mortensen2015oasis"

\end_inset

.
 These methods are classified into three classes; the velocity-correction,
 the pressure-correction, and the consistent splitting methods.
 The common feature of these methods is that one typically starts by discretizin
g in time and treat the convective velocity explicitly, whereas the viscous
 term and the pressure are treated implicitly.
 The most appealing feature of fractional step methods is that at each time
 step one only is required to solve a sequence of the decoupled Navier-Stokes
 equations for the velocity and the pressure, making it a very efficient
 strategy for large scale numerical simulations.
\end_layout

\begin_layout Subsubsection
Adams-Bashforth Crank-Nicolson (ABCN)
\end_layout

\begin_layout Standard
Writing the governing equations to be discretized and linearized once again
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial\boldsymbol{u}}{\partial t}+(\boldsymbol{u}\cdot\nabla)\boldsymbol{u}=-\frac{1}{\rho}\nabla p+\nu\nabla^{2}\boldsymbol{u}+\boldsymbol{f}\label{eq:NSO}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\cdot\boldsymbol{u}=0\label{eq:CO}
\end{equation}

\end_inset

where the velocity vector is 
\begin_inset Formula $\boldsymbol{u}(\boldsymbol{x},t)$
\end_inset

, the constant fluid density is incorporated in the pressure 
\begin_inset Formula $p(\boldsymbol{x},t)$
\end_inset

 , the kinematic viscosity 
\begin_inset Formula $\nu$
\end_inset

, and any volumetric or gravitational forces like buoyancy are denoted as
 
\begin_inset Formula $\boldsymbol{f}(\boldsymbol{x},t)$
\end_inset

, but for simplicity we will discard this term since in microfluidics the
 volumetric forces are less important 
\begin_inset CommandInset citation
LatexCommand cite
key "whitesides2006origins,sackmann2014present"

\end_inset

.
 The velocity and the pressure are solved separately with the fractional
 step method.
 The temporal domain 
\begin_inset Formula $t\in[0,T]$
\end_inset

 is uniformly distributed with constant time step 
\begin_inset Formula $\Delta t=\frac{T}{N}$
\end_inset

 such that 
\begin_inset Formula $t=k\Delta t$
\end_inset

, where 
\begin_inset Formula $k=0,1,\ldots,N$
\end_inset

.
 The velocity and the pressure at time step 
\begin_inset Formula $k$
\end_inset

 is given as 
\begin_inset Formula $\boldsymbol{u}^{k}$
\end_inset

 and 
\begin_inset Formula $p^{k}$
\end_inset

.
 
\end_layout

\begin_layout Standard
A midpoint Crank-Nicolson evaluation is given by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\frac{\partial\boldsymbol{u}}{\partial t}\right]^{k+\frac{1}{2}}+\left[(\boldsymbol{u}\cdot\nabla)\boldsymbol{u}\right]^{k+\frac{1}{2}}=-\frac{1}{\rho}\nabla p^{k+\frac{1}{2}}+\nu\nabla^{2}\boldsymbol{u}^{k+\frac{1}{2}}
\]

\end_inset

where the transient term may be discretized by a 2-step central difference
 scheme that is second order accurate in time by 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left[\frac{\partial\boldsymbol{u}}{\partial t}\right]^{k+\frac{1}{2}}=\frac{\boldsymbol{u}^{k+1}-\boldsymbol{u}^{k}}{\Delta t}+\mathcal{O}(\Delta t^{2})
\]

\end_inset

An implicit approximation at time step 
\begin_inset Formula $k+\frac{1}{2}$
\end_inset

 for the velocity is 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{u}^{k+\frac{1}{2}}=\frac{\boldsymbol{u}^{k+1}-\boldsymbol{u}^{k}}{\Delta t}+\mathcal{O}(\Delta t^{2})\label{eq:impApproxu}
\end{equation}

\end_inset

The convective term is linearized by 
\begin_inset Formula 
\[
\left[(\boldsymbol{u}\cdot\nabla)\boldsymbol{u}\right]^{k+\frac{1}{2}}=(\underline{\boldsymbol{u}}^{k+\frac{1}{2}}\cdot\nabla)\boldsymbol{u}^{k+\frac{1}{2}}
\]

\end_inset

The only known and allowed velocity is the explicit convective velocity
 
\begin_inset Formula $\underline{\boldsymbol{u}}^{k+1/2}$
\end_inset

 which is approximated at 
\begin_inset Formula $k+\frac{1}{2}$
\end_inset

 with a second order accurate Adams-Bashforth projection
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\underline{\boldsymbol{u}}^{k+\frac{1}{2}}=\frac{3}{2}\boldsymbol{u}^{k}-\frac{1}{2}\boldsymbol{u}^{k-1}+\mathcal{O}(\Delta t^{2})
\]

\end_inset

And the pressure is also naturally evaluated at the midpoint 
\begin_inset Formula $k$
\end_inset

 and 
\begin_inset Formula $k+1$
\end_inset

 and will be solved solved directly at 
\begin_inset Formula $p^{k+\frac{1}{2}}$
\end_inset

 instead of 
\begin_inset Formula $p^{k}$
\end_inset

.
 This means that both velocity and the pressure will be staggered in time,
 which leads to the following scheme 
\begin_inset Formula 
\begin{equation}
\frac{1}{\Delta t}(\boldsymbol{u}^{k+1}-\boldsymbol{u^{k}})+\left((\frac{3}{2}\boldsymbol{u}^{k}-\frac{1}{2}\boldsymbol{u}^{k-1}\cdot\nabla)\right)\boldsymbol{u}^{k+\frac{1}{2}}=-\frac{1}{\rho}\nabla p^{k+\frac{1}{2}}+\nu\nabla^{2}\boldsymbol{u}^{k+\frac{1}{2}}\label{eq:NSfracstep}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\boldsymbol{u}^{k+1}=\boldsymbol{u^{k}}-\Delta t\left(\left((\frac{3}{2}\boldsymbol{u}^{k}-\frac{1}{2}\boldsymbol{u}^{k-1}\cdot\nabla)\right)\boldsymbol{u}^{k+\frac{1}{2}}-\frac{1}{\rho}\nabla p^{k+\frac{1}{2}}+\nu\nabla^{2}\boldsymbol{u}^{k+\frac{1}{2}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\cdot\boldsymbol{u}^{k+1}=0\label{eq:Cstep}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The velocity must be initialized on two time steps with no need for modification
s because the convective term will be degraded(will loss accuracy) to first
 order accurate 
\begin_inset Formula $(\boldsymbol{u}^{0}\cdot\nabla)\boldsymbol{u}^{\frac{1}{2}}$
\end_inset

.
 One could alternatively compute the convective velocity by iterating the
 first time step from the last known approximation from the explicit midpoint
 rule eq.(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:impApproxu"

\end_inset

) e.g 
\begin_inset Formula $(\underline{\boldsymbol{u}}^{\frac{1}{2}}\cdot\nabla)\boldsymbol{u}^{\frac{1}{2}}$
\end_inset

.
 
\end_layout

\begin_layout Standard
There are still some major issues with the scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:NSfracstep"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Cstep"

\end_inset

) that need to be addressed.
 First, we don't have any update for the pressure term.
 Second, conservation of mass is generally not satisfied.
 The solution to these problems will be the topic of the next paragraph.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
why not 
\begin_inset Formula $\nabla\cdot\boldsymbol{u}^{k+\frac{1}{2}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\boldsymbol{u}^{\star}=\boldsymbol{u}^{k}-\Delta t\left((\underline{\boldsymbol{u}}^{k+1/2}\cdot\nabla)\boldsymbol{u}^{k+\frac{1}{2}}+\nu\nabla^{2}\boldsymbol{u}^{k+\frac{1}{2}}-\frac{1}{\rho}\nabla p^{k-\frac{1}{2}}\right)
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Incremental Pressure Correction Scheme (IPCS)
\end_layout

\begin_layout Standard
Pressure correction schemes are a class of time-stepping techniques consisting
 of two sub-steps for each time step
\begin_inset CommandInset citation
LatexCommand cite
key "guermond2006overview"

\end_inset

.
 The pressure is either treated explicitly or ignored in the first sub-step
 and is corrected in the second one by projecting the previous velocity
 onto the test space.
 
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
(which leads to a first order accurate scheme due to splitting errors, while
 an implicit )
\end_layout

\end_inset

A common way to satisfy the continuity equation (divergence free velocity),
 is to introduce a velocity guess often termed tentative velocity 
\begin_inset Formula $u^{\star}$
\end_inset

.
 The velocity at time step 
\begin_inset Formula $k+1$
\end_inset

 is then taken as the sum of the tentative velocity and a correcting velocity
 
\begin_inset Formula $u_{c}$
\end_inset

, where the correction term makes sure that mass is conserved.
 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\boldsymbol{u}^{k+1}=\boldsymbol{u}^{\star}+\boldsymbol{u}_{c}
\end{equation}

\end_inset

Same procedure can be applied to the pressure by introducing a pressure
 correction 
\begin_inset Formula $\phi^{k+1}$
\end_inset

.
 A second order accurate second IPCS can be summed up with three steps:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\frac{1}{2\Delta t}(3\boldsymbol{u}^{\star}-4\boldsymbol{u^{k}}+\boldsymbol{u}^{k-1})+(\underline{\boldsymbol{u}}^{k+1}\cdot\nabla)\boldsymbol{u}^{\star}=\nu\nabla^{2}\boldsymbol{u}^{\star}-\nabla p^{\star}\qquad\boldsymbol{u}^{\star}\mid_{\Gamma}=0$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\begin{cases}
\frac{3}{2\Delta t}(\boldsymbol{u}^{k+1}-\boldsymbol{u}^{\star})= & -\nabla\phi^{k+1}\\
\nabla\cdot\boldsymbol{u}^{k+1}=0, & \boldsymbol{u}^{k+1}\cdot\boldsymbol{n}\mid_{\Gamma}
\end{cases}$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $p^{k+1}=p^{\star}+\phi^{k+1}$
\end_inset


\end_layout

\begin_layout Standard
The algorithm for the IPC is given in 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:Incremental-pressure-correction"

\end_inset

, and a brief implementation in FEniCS is given in listing.
 
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Incremental pressure correction
\begin_inset CommandInset label
LatexCommand label
name "alg:Incremental-pressure-correction"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Time-stepping:
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $t=\Delta t$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Initialize:
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

 
\begin_inset Formula $\boldsymbol{u}^{0},\boldsymbol{u}^{-1},p^{0},k=0,t^{0}=0$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
While
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $t<T+\mbox{DOLFIN\_EPS}$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $t\gets t+\Delta t$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $k\gets k+1$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $k\gets k+1$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
While
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\mbox{error}>\mbox{to}$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

solve step 1 for
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\boldsymbol{u}^{\star}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
Comment
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Computing tentative velocity
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

solve step 2 for
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\phi^{k+1}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
Comment
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Computing pressure correction
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

update
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $p^{k+1}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

and
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\boldsymbol{u}^{k+1}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
EndWhile
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "IPC"

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\boldsymbol{u}^{k-1}\leftarrow\boldsymbol{u}^{k}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $\boldsymbol{u}^{k}\leftarrow\boldsymbol{u}^{k+1}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $p^{k}\leftarrow p^{k+1}$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndWhile
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
The governing equations to be discretized and linearized in Oasis are thus
\end_layout

\begin_layout Plain Layout
where the velocity vector is 
\begin_inset Formula $\boldsymbol{u}(\boldsymbol{x},t)$
\end_inset

, the constant fluid density is incorporated in the pressure is 
\begin_inset Formula $p(\boldsymbol{x},t)$
\end_inset

 , the kinematic viscosity 
\begin_inset Formula $\nu$
\end_inset

, the concentration of species 
\begin_inset Formula $c_{\alpha}$
\end_inset

 with the corresponding diffusivity 
\begin_inset Formula $D_{\alpha}$
\end_inset

 and any volumetric or gravitational forces like buoyancy are denoted as
 
\begin_inset Formula $\boldsymbol{f}(\boldsymbol{x},t)$
\end_inset

.
 Other scalar sources like the chemical reaction rate is 
\begin_inset Formula $f_{\alpha}(\boldsymbol{c})$
\end_inset

, where 
\begin_inset Formula $\boldsymbol{c}(\boldsymbol{x},t)$
\end_inset

 is the vector of concentration of all species.
 The velocity and the pressure are solved separately with the fractional
 step method (NSfracStep.py).
 Optionally, Oasis has another method where the velocity and the pressure
 are solved simultaneously through a coupled solver (NSCoupled.py).
 In the fractional step method, the velocity vector are divided into its
 components 
\begin_inset Formula $u_{k}$
\end_inset

 which will increase the efficiency of the constructed solver.
 The temporal domain 
\begin_inset Formula $t\in[0,T]$
\end_inset

 is uniformly distributed with constant time step 
\begin_inset Formula $\Delta t=t^{n}-t^{n-1}$
\end_inset

 for integer 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $t^{n}\in\mathcal{R}^{+}$
\end_inset

 .
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
0=t^{0}<t^{1}<t^{2}<\cdots<t^{N_{t-1}}<t^{N_{t}}=T
\]

\end_inset


\end_layout

\begin_layout Plain Layout
The most common approach in discretizing a partial differential equation
 in combination with FEM is to discretize the spatial terms with FEM and
 the temporal terms with finite difference method FDM.
 The local acceleration is discretized by the backward Euler method, while
 the convective and the source term is discretized by the midpoint method.
 Thus, the generic fractional step algorithm goes as follows 
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\frac{u^{I}-u^{n-1}}{\Delta t}+B_{k}^{n-\frac{1}{2}}=-\nabla_{k}p^{*}+\nu\nabla_{k}^{2}\tilde{u}_{k}+f^{n-\frac{1}{2}}\qquad\textrm{for}\qquad k=1,\ldots,d\label{eq:Oasis4}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\nabla^{2}\phi=-\frac{1}{\Delta t}\nabla\cdot\boldsymbol{u}^{I}\label{eq:Oasis5}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\frac{u_{k}^{n}-u_{k}^{I}}{\Delta t}=\nabla_{k}\phi\qquad\textrm{for}\qquad k=1,\ldots,d\label{eq:Oasis6}
\end{equation}

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{equation}
\frac{c_{\alpha}^{n}-c_{\alpha}^{n-1}}{\Delta t}+B_{\alpha}^{n-\frac{1}{2}}=D_{\alpha}\nabla^{2}\tilde{c}_{\alpha}+f_{\alpha}^{n-\frac{1}{2}}\label{eq:Oasis7}
\end{equation}

\end_inset

where 
\begin_inset Formula $u_{k}^{n}$
\end_inset

 is the velocity vector at time 
\begin_inset Formula $t^{n}$
\end_inset

 with component 
\begin_inset Formula $k=1,\ldots,d$
\end_inset

 , 
\begin_inset Formula $d$
\end_inset

 is the dimension of the problem and the pressure correction term 
\begin_inset Formula $\phi=p^{n-\frac{1}{2}}-p*$
\end_inset

 where the asterisk 
\begin_inset Formula $p*$
\end_inset

 is a tentative pressure and .
 The velocity and the pressure are solved for on the next time step 
\begin_inset Formula $u_{k}^{n}$
\end_inset

 and 
\begin_inset Formula $p^{n-\frac{1}{2}}$
\end_inset

, furthermore the tentative velocity 
\begin_inset Formula $u_{n}^{I}$
\end_inset

 is solved as unknown.
 The viscous term is discretized by a semi implicit Crank–Nicolson interpolated
 velocity component to avoid strict time step restrictions.
 
\begin_inset Formula 
\[
\tilde{u}_{k}=\frac{1}{2}(u_{k}^{I}+u_{k}^{n-1})
\]

\end_inset


\end_layout

\begin_layout Plain Layout
In Oasis there are two approaches in discretization of the nonlinear convective
 term 
\begin_inset Formula $B_{k}^{n-\frac{1}{2}}$
\end_inset

, where both are evaluated at the midpoint between 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $n-1$
\end_inset

 indicated by 
\begin_inset Formula $n-\frac{1}{2}$
\end_inset

.
 The first approach is a fully explicit Adams–Bashforth discretization
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
B_{k}^{n-\frac{1}{2}}=\frac{3}{2}\boldsymbol{u}^{n-1}\cdot\nabla u_{k}^{n-1}-\frac{1}{2}\boldsymbol{u}^{n-2}\cdot\nabla u_{k}^{n-2}
\]

\end_inset

and the second is a implicit 
\end_layout

\begin_layout Plain Layout
\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Incremental pressure correction
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
Procedure
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Euclid
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $a,b$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
Comment
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

The g.c.d.
 of a and b
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $r\gets a\bmod b$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
If
\end_layout

\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $r\not=0$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
While
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset Formula $r\not=0$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Comment
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

We have the answer if r is 0
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $a\gets b$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $b\gets r$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $r\gets a\bmod b$
\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
EndWhile
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "euclidendwhile-1"

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
EndIf
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\series bold
return
\series default
 
\begin_inset Formula $b$
\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
Comment
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

The g.c.d.
 is b
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
EndProcedure
\end_layout

\end_inset

 
\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset

 
\end_layout

\end_inset

Note that the pressure is included in the first step
\begin_inset Formula 
\[
\frac{\partial c_{\alpha}}{\partial t}+\boldsymbol{u}\cdot\nabla c_{\alpha}=D_{\alpha}\nabla^{2}c_{\alpha}+f_{\alpha}
\]

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula $\mbox{I}:\qquad\frac{1}{2\Delta t}(3\boldsymbol{u}^{\star}-4\boldsymbol{u^{k}}+\boldsymbol{u}^{k-1})+(\underline{\boldsymbol{u}}^{k+1}\cdot\nabla)\boldsymbol{u}^{\star}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\[
\begin{array}{ccccc}
\mbox{I:} & \frac{1}{2\Delta t}(3\boldsymbol{u}^{\star}-4\boldsymbol{u^{k}}+\boldsymbol{u}^{k-1})+(\underline{\boldsymbol{u}}^{k+1}\cdot\nabla)\boldsymbol{u}^{\star} & = & \nu\nabla^{2}\boldsymbol{u}^{\star}-\nabla p^{k},\qquad & \boldsymbol{u}^{\star}\mid_{\Gamma}=0\\
\mbox{II:} & \begin{cases}
\frac{3}{2\Delta t}(\boldsymbol{u}^{k+1}-\boldsymbol{u}^{\star}) & =-\nabla\phi^{k+1}\\
\nabla\cdot\boldsymbol{u}^{k+1}=0,\qquad\boldsymbol{u}^{k+1}\cdot\boldsymbol{n}\mid_{\Gamma}
\end{cases}\\
\mbox{III:} & p^{k+1}=p^{k}+\phi^{k+1}
\end{array}
\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

# Time-stepping 
\end_layout

\begin_layout Plain Layout

t = dt 
\end_layout

\begin_layout Plain Layout

while t < T + DOLFIN_EPS:
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    #Compute tentative velocity step     
\end_layout

\begin_layout Plain Layout

    begin("Computing tentative velocity")     
\end_layout

\begin_layout Plain Layout

    b1 = assemble(L1)     
\end_layout

\begin_layout Plain Layout

    [bc.apply(A1, b1) for bc in bcu]     
\end_layout

\begin_layout Plain Layout

    solve(A1, u1.vector(), b1, "gmres", "default")     
\end_layout

\begin_layout Plain Layout

    end()
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    #Pressure correction     
\end_layout

\begin_layout Plain Layout

    begin("Computing pressure correction")     
\end_layout

\begin_layout Plain Layout

    b2 = assemble(L2)     
\end_layout

\begin_layout Plain Layout

    [bc.apply(A2, b2) for bc in bcp]     
\end_layout

\begin_layout Plain Layout

    solve(A2, p1.vector(), b2, "cg", prec)     
\end_layout

\begin_layout Plain Layout

    end()
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    # Velocity correction     
\end_layout

\begin_layout Plain Layout

    begin("Computing velocity correction")     
\end_layout

\begin_layout Plain Layout

    b3 = assemble(L3)     
\end_layout

\begin_layout Plain Layout

    [bc.apply(A3, b3) for bc in bcu]     
\end_layout

\begin_layout Plain Layout

    solve(A3, u1.vector(), b3, "gmres", "default")     
\end_layout

\begin_layout Plain Layout

    end()
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

    # Plot solution and save to file 
\end_layout

\begin_layout Plain Layout

    .
\end_layout

\begin_layout Plain Layout

    .
  
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Verification 
\end_layout

\begin_layout Standard
Code verification is naturally very important in CFD.
 There exist several approaches in verifying a code, each with its strengths
 and shortcomings.
 Naming some of the most used techniques which includes; exact analytical
 solutions, method of manufactured solution (MMS) and exact solution of
 the discrete equations.
 We will use use the method of manufactured solutions (MMS) for our code
 verification.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
With a manufactured or known analytical solution, as outlined above, we
 can estimate
\begin_inset CommandInset citation
LatexCommand citep
key "HPLWave"

\end_inset

 convergence rates and see if they have the correct asymptotic behavior.
 Experience shows that this is a quite good verification technique in that
 many common bugs will destroy the convergence rates.
 A significantly better test though, would be to check that the numerical
 solution is exactly what it should be.
 This will in general require exact knowledge of the numerical error, which
 we do not normally have.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Manufactured solution
\end_layout

\begin_layout Standard
The idea of manufactured solutions is to construct a solution and fit the
 source term, initial and boundary conditions such that they are compatible
 with the chosen solution.
 The code is then verified by computing the convergence rates in a series
 of simulations, and see if they have the correct asymptotic behavior, where
 each simulation uses a finer mesh then the previous one.
 The convergence rates tests is based on the assumption that there is a
 number 
\begin_inset Formula $E$
\end_inset

 of the numerical error which related the discretization parameters through
\begin_inset Formula 
\[
E=C_{t}\Delta t^{r}+C_{x}\Delta t^{p}
\]

\end_inset

where 
\begin_inset Formula $C_{t}$
\end_inset

, 
\begin_inset Formula $C_{x}$
\end_inset

, 
\begin_inset Formula $r$
\end_inset

, and 
\begin_inset Formula $p$
\end_inset

 are constants, where 
\begin_inset Formula $p$
\end_inset

 and 
\begin_inset Formula $r$
\end_inset

 are the convergence rates in space and time.
 From the accuracy in FD approximations where the order of errors are 
\begin_inset Formula $\Delta t^{2}$
\end_inset

 and 
\begin_inset Formula $\Delta x^{2}$
\end_inset

, we expect that 
\begin_inset Formula $r$
\end_inset

 and 
\begin_inset Formula $p$
\end_inset

 to be 
\begin_inset Formula $r=p=2$
\end_inset

, which is confirmed by among others, the truncation error analysis 
\begin_inset CommandInset citation
LatexCommand citep
key "HPLWave"

\end_inset

.
 
\end_layout

\begin_layout Standard
We introduce a single discretization parameter 
\begin_inset Formula $h=\Delta t=\hat{c}\Delta x$
\end_inset

, for some constant 
\begin_inset Formula $\hat{c}$
\end_inset

, and use the relation between 
\begin_inset Formula $\Delta x$
\end_inset

 and 
\begin_inset Formula $\Delta t$
\end_inset

 through the Courant number defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
C=u\frac{\Delta t}{\Delta x}\leq C_{max}
\]

\end_inset

We can then express it as follows 
\begin_inset Formula 
\[
\Delta x=\frac{hc}{C}
\]

\end_inset

Now we get a simplified expression for the error
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E=C_{t}\Delta t^{r}+C_{x}\Delta x^{r}=C_{t}h^{r}+C_{x}\left(\frac{c}{C}\right)^{r}h^{r}=Dh^{r}
\]

\end_inset

where 
\begin_inset Formula 
\[
D=C_{t}+C_{x}\left(\frac{c}{C}\right)^{r}
\]

\end_inset

The idea now is to choose an initial discretization parameter 
\begin_inset Formula $h_{0}$
\end_inset

 and then run experiments while we decrease 
\begin_inset Formula $h$
\end_inset

: 
\begin_inset Formula $h_{i}=2^{-i}h_{0}$
\end_inset

, 
\begin_inset Formula $i=1,2,...,m$
\end_inset

.
 i.e.
 halving 
\begin_inset Formula $h$
\end_inset

 in each experiment, which is not necessary but a common practice.
 Both 
\begin_inset Formula $E$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 are recorded in each experiment, and a standard choice of error measure
 is the 
\begin_inset Formula $l^{2}$
\end_inset

 or 
\begin_inset Formula $l^{\infty}$
\end_inset

 of the error mesh function 
\begin_inset Formula $e_{i}^{n}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E=\mid\mid e_{i}^{n}\mid\mid_{l^{2}}=\left(\Delta t\Delta x\sum_{n=0}^{N_{t}}\sum_{i=0}^{N_{x}}(e_{i}^{n})^{2}\right)^{\frac{1}{2}},\qquad e_{i}^{n}=u_{e}(x_{i},t_{n})-u_{i}^{n}
\]

\end_inset


\end_layout

\begin_layout Standard
If now 
\begin_inset Formula $E_{i}$
\end_inset

 is the error measure experiment/mesh number 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $h_{i}$
\end_inset

 is the corresponding discretization parameter 
\begin_inset Formula $h$
\end_inset

, we can use the error model 
\begin_inset Formula $E_{i}=Dh^{r}$
\end_inset

 to estimate 
\begin_inset Formula $r$
\end_inset

 by comparing two consecutive experiments:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
E_{i+1} & = & Dh_{i+1}^{r}\\
E_{i} & = & Dh_{i}^{r}
\end{eqnarray*}

\end_inset

Then we divide these two equations and solve for 
\begin_inset Formula $r$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r=\frac{\ln\left(\frac{E_{i+1}}{E_{i}}\right)}{\ln\left(\frac{h_{i+1}}{h_{i}}\right)}
\]

\end_inset

Since 
\begin_inset Formula $r$
\end_inset

 depends on 
\begin_inset Formula $i$
\end_inset

, in other word which simulation we compare, we may add an index to 
\begin_inset Formula $r$
\end_inset

: 
\begin_inset Formula $r_{i}$
\end_inset

, where 
\begin_inset Formula $i=0,...,m-2$
\end_inset

, if we have m experiments: (
\begin_inset Formula $h_{0},E_{0}),...,(h_{m-1},E_{m-1})$
\end_inset

 and we expect 
\begin_inset Formula $r$
\end_inset

 to converge 
\begin_inset Formula $r=2$
\end_inset

 as 
\begin_inset Formula $i$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Navier-Stokes Equations: Theory and Numerical Methods -Salvi
\end_layout

\begin_layout Plain Layout
\begin_inset Formula 
\begin{eqnarray*}
u & = & -\cos(x)\sin(y)g(t)\\
v & = & \sin(x)\cos(y)g(t)\\
p & = & \frac{1}{4}\left[\cos(2x)+\sin(2y)\right]g^{2}(t)\\
g(t) & = & \sin(2t)
\end{eqnarray*}

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Results and discussion 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
We will show in this section that there are many challenges
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This thesis eventually boiled down to finding an appropriate value for 
\begin_inset Formula $C$
\end_inset

 which would give us some constant 
\begin_inset Formula $R$
\end_inset

 on which we got the streamlines of the experiment.
 This was presumed to be an trivial effort, because one could just run several
 simulations, take notes of the patterns and rule out inappropriate flow
 behaviors.
 Well, this turned out to be an highly challenging task, to put it mildly.
 The RBC was extremely sensitive and unpredictable to the chosen 
\begin_inset Formula $C$
\end_inset

.
 Not only was there major discrepancies in 
\begin_inset Formula $R$
\end_inset

 between 2D simulations and 3D simulations with different 
\begin_inset Formula $C$
\end_inset

's, also different Reynolds numbers would give different 
\begin_inset Formula $R$
\end_inset

's.
 Even with equally spaced 
\begin_inset Formula $C$
\end_inset

's one could not predict the outcome of the flow, especially for the 2D
 case.
 In addition, the mesh resolution was very important, coarse meshes was
 much more sensitive to R than fine, for instance the coarsest mesh would
 give R=900 very fast with Re=2.2 and C=1e-5 and diverge immediately with
 C=1e3 
\end_layout

\begin_layout Standard
Numerous runs was made to figure out how 
\begin_inset Formula $C$
\end_inset

 influence the streamline , and we will now elaborate in the effort made
 to emulate the experiment.
 To this end, two mandatory criteria was stated: 
\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $C$
\end_inset

 such that 
\begin_inset Formula $R$
\end_inset

 converges to a constant, where a constant 
\begin_inset Formula $R$
\end_inset

 implies that we have a steady-state flow.
 This 
\begin_inset Formula $R$
\end_inset

 was roughly estimated to be somewhere between: 
\begin_inset Formula $3<R<10$
\end_inset

 
\end_layout

\begin_layout Enumerate
Does this 
\begin_inset Formula $R$
\end_inset

 resemble the streamlines of the experiment? 
\end_layout

\begin_layout Standard
To address the first one, many 
\begin_inset Formula $C$
\end_inset

's in some given range would make 
\begin_inset Formula $R$
\end_inset

 to converge to steady-state, some sooner than others.
 Just to mention in a subordinate clause; to pinpoint an exact value for
 
\begin_inset Formula $C$
\end_inset

 is naturally pointless, because it implies that we know every detail of
 the experiment exactly.
 And even if we did, the RBC would be redundant.
 The whole point of the RBC is that we don't have any knowledge of the pressure
 at the outlets, in such way we have to model the pressure in a reasonable
 manner.
 Anyway, any reasonable 
\begin_inset Formula $C$
\end_inset

 that gives something near the 
\begin_inset Quotes eld
\end_inset

real
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $C$
\end_inset

 in which would give us the streamlines we are seeking for would do the
 job.
 Fortunately, we have a linear dependency between the pressure and the velocity
 at each outlet, which makes us take the advantage of letting the downstream
 flow figure out an appropriate pressure.
 Writing the RBC once again
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
p_{i}=p_{0}+R=p_{0}+C\int u_{i}\cdot\boldsymbol{n}\textrm{ds}_{i}
\]

\end_inset


\end_layout

\begin_layout Standard
Note that since we are dealing with a somehow 
\begin_inset Quotes eld
\end_inset

non-physical
\begin_inset Quotes erd
\end_inset

 flow i.e water in rigid walls versus blood flow in capillaries , and the
 mentioned unknown pressure at the outlets, we may neglect the atmospheric
 pressure.
 However, 
\begin_inset Formula $p0$
\end_inset

 was chosen a very small number, just to avoid zero division error on the
 first time step when calculating and plotting the evolution of 
\begin_inset Formula $R=\frac{R_{3}}{R_{2}}$
\end_inset

.
 We can rule out this impact on the results because even if we add the contribut
ions of 
\begin_inset Formula $1e+10$
\end_inset

 time steps, we get 
\begin_inset Formula $p_{0}=10^{-90}\approx0$
\end_inset

.
 Initially, 
\begin_inset Formula $C$
\end_inset

 could be any number, but at least it was expected to be small due to informatio
n from other flow parameters.
 A natural starting point would be to take 
\begin_inset Formula $C=1$
\end_inset

.
 This would diverge immediately and kill the run.
 So the next guess was an order lower: 
\begin_inset Formula $C=0.1$
\end_inset

.
 Now the simulation would run normally, but the outflow from the smallest
 outlet1 was way to high, so this order was also discarded.
 As we decreased the order of 
\begin_inset Formula $C$
\end_inset

 , the flow would look more and more naturally, up to some point.
 
\end_layout

\begin_layout Standard
Naming some common characteristics of 2D and 3D simulations in terms of
 
\begin_inset Formula $C$
\end_inset

: Increasing 
\begin_inset Formula $C$
\end_inset

 gives decreasing 
\begin_inset Formula $R$
\end_inset

 and faster convergence.
 This means that we get steady-state faster, but on the other hand a fast
 convergence does not do the job alone, because it also implies that it
 goes way to much out of the smallest outlet (out1).
 The 2D simulations was convergence friendly, the latest registered steady-state
 was around 
\begin_inset Formula $\mbox{tstep}=5600$
\end_inset

 (flat 
\begin_inset Formula $R$
\end_inset

), but there was no way to predict the streamlines or 
\begin_inset Formula $R$
\end_inset

 whatsoever, non of the simulation resembled the experiment.
 In 3D however it was the opposite, 
\begin_inset Formula $C$
\end_inset

 was still very sensitive but much more predictable and domesticated in
 terms of streamlines, but it would take forever to get a flat 
\begin_inset Formula $R$
\end_inset

.
 Even at 
\begin_inset Formula $\mbox{tstep}=1\cdot10^{5}$
\end_inset

 it was not flat, but very close 
\begin_inset Formula $R_{i}-R_{i-1000}\approx0.01\%$
\end_inset

.
 Additionally, a change in 
\begin_inset Formula $Re$
\end_inset

 would change 
\begin_inset Formula $R$
\end_inset

 whitin the same 
\begin_inset Formula $C$
\end_inset

.
 If there was some linear relation between this difference one could just
 introduce a constant, say 
\begin_inset Formula $\gamma$
\end_inset

 expressed it in terms of Reynolds number such that 
\begin_inset Formula $\gamma R_{2.2}=R_{84}$
\end_inset

.
 Note that 
\begin_inset Formula $R_{84}$
\end_inset

 must not be confused with 
\begin_inset Formula $Re=84$
\end_inset

, 
\begin_inset Formula $R_{84}$
\end_inset

 means the ratio 
\begin_inset Formula $R=R_{3}/R_{2}$
\end_inset

 with 
\begin_inset Formula $Re=84$
\end_inset

.
 As a simple illustration some selected values of 
\begin_inset Formula $C$
\end_inset

 and the corresponding 
\begin_inset Formula $R$
\end_inset

's at steady-state are given in fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:How-different-Reynolds"

\end_inset

.
 The two lowest 
\begin_inset Formula $C$
\end_inset

's are not included in the plot.
 Notice that 
\begin_inset Formula $Re=84$
\end_inset

 has a much more stable and narrower range with different 
\begin_inset Formula $C$
\end_inset

's, i.e the range of 
\begin_inset Formula $R_{2.2}=[1.9,...,40]>R_{84}=[2.1,...,15.5]$
\end_inset

 (greyed).
 Why this difference? Initially, the guess was that 
\begin_inset Formula $R$
\end_inset

 would remain more or less the same as we increased Re, at least it would
 not differ so dramatically.
 Maybe the answer is in Bernoulli's principle ; an increase in velocity
 results in a decrease in pressure, and vice versa, a decrease in velocity
 makes pressure more dominant? because a low 
\begin_inset Formula $C$
\end_inset

 gives a low 
\begin_inset Formula $p$
\end_inset

, i.e.
 
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
because a low 
\begin_inset Formula $C$
\end_inset

 gives a low 
\begin_inset Formula $p$
\end_inset

, i.e.
 
\end_layout

\begin_layout Plain Layout
CFL:5020,Re220 
\end_layout

\begin_layout Plain Layout
dt=10, , CFL=[0.007,-0.0008],
\end_layout

\begin_layout Plain Layout
dt=[0.006, -0.006]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="10" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $C$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R_{2.2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta R[\%]$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $R_{84}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta R[\%]$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1\cdot10^{-2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1.9$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\star$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.5\cdot10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $15.8\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $14.3\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5\cdot10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.7$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $22.7\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3.0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $25\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.25\cdot10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $4.4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $63\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.7$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $56.7\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1\cdot10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.9$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $102\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $55.3\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.5\cdot10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $11.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $25.8\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $16.4\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5\cdot10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $15.2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $35.7\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10.1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $18.8\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.25\cdot10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $26.3$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $73\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $30.7\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1\cdot10^{-4}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $40$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $52.1\%$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $15.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $17.4\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Re=2.2
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/an2D_R_C_Re.png
	scale 55

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Caption Standard

\begin_layout Plain Layout
The effect of 
\begin_inset Formula $Re$
\end_inset

 on 
\begin_inset Formula $R$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "fig:How-different-Reynolds"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt100ts250coarse.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt100ts50coarse.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt10ts250coarse.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt10ts50coarse.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The sensitivity of the coarse mesh: C an3D fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Mesh-info"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
frew
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssR2t200.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssR84t200.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Steady-state an2D
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The experiment
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt100ts250coarse.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt100ts50coarse.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt10ts250coarse.png
	scale 40

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/ssRdt10ts50coarse.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
The sensitivity of the coarse mesh: C an3D fig.
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Mesh-info"

\end_inset

 
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align left
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/CR.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/first5.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/C2R.png
	scale 40

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/plots/C2_1e5.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align left
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/ResultsPNG/Re220/inlet12e5Re220dp215e4.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re220.png
	scale 20

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/ResultsPNG/Re220/lc.tif
	scale 7.2

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/ResultsPNG/Re220/26oct1.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/ResultsPNG/Re220/26oct2.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re2.png
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=2.2$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re84.png
	scale 20

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=84$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re110.png
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=110$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re170.png
	scale 20

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=170$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space \hspace{}
\length -2.3cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re220.png
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=220$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hspace{}
\length 2cm
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /Users/Mo/Documents/repos/master-thesis/Graphics/epje/Re340.png
	scale 20

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset Formula $Re=340$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
The experiment 
\begin_inset CommandInset citation
LatexCommand citep
key "kolaas2013visualization"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "float"
inline false
status open

\begin_layout Plain Layout

cec
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Grinberg:In terms of computational complexity, R-BC is more expensive than
 the constant pressure BC, since the integral of velocity at each outlet
 must be computed at each time step.
 Nevertheless, it involves a perfectly parallelizable implementation, which
 requires only a subset of processors for computing the integral and performing
 blocking communication (blocking communication requires synchronization
 of processors, i.e., if one completes its task early it will still wait for
 other processors to finish their tasks, which degrades the performance
 of the numerical solver).21 Moreover, these processors can be grouped in
 disjoint groups—one per each outlet in order to overlap the computation
 of the integral and perform blocking communication within each group concurrent
ly
\end_layout

\begin_layout Plain Layout
important!!!: http://www.aeromech.usyd.edu.au/~kirkpatrick/papers/kirkpatrick-armfie
ld-anziamj-08.pdf
\end_layout

\begin_layout Plain Layout
Majidi
\end_layout

\begin_layout Plain Layout
Smoothed Particle Hydrodynamics (SPH) is a Lagrangian particle method that
 originated from astrophysical problems some three decades ago [1,2].
 In recent years, it has evolved into a unique tool for computational fluid
 dynamics thanks to its meshless formalism and unique capability to handle
 large strains and morphological changes [3–5].
 Nevertheless, SPH is still a relatively new tool in computational fluid
 dynamics, and is not as well developed as finite difference or finite element
 [6, 7].
 Some fundamental issues, such as the treatment of incompressibility and
 boundary conditions, have not been fully resolved.
\end_layout

\begin_layout Plain Layout
StabConvNS.pdf:
\end_layout

\begin_layout Plain Layout
Yet most existing computational methods able to handle the difficulties
 are sophisticated and lack the robustness and flexibility that would be
 useful to address more complex problems.
 For example, many finite element methods require the solution of Stokes
 equations that couple velocity and pressure, and great care is required
 to arrange that the approximation spaces for these variables are compatible
 in the sense that an inf-sup condition holds that ensures stability [GR,
 FB].
 Stabilized finite element methods have been developed that allow one to
 circumvent such compatibility conditions, but at the cost of additional
 complexity [BBGS].
 Projection methods, pioneered by Chorin [Ch1, Ch2] and Temam [Te2], achieved
 a separation between updates of velocity and pressure through a splitting
 strategy.
 It has proved difficult, however, to achieve high-order accuracy for pressure
 near boundaries [OID]—uniform second-order accuracy was attained only a
 few years ago [Ti, BCM].
\end_layout

\begin_layout Plain Layout
....In particular we establish unconditional stability and convergence for a
 class of fully discrete finite element methods which need not satisfy any
 compatibility requirement related to an inf-sup condition, for the case
 of no-slip boundary conditions.
 Our theory is based on a new, sharp estimate in L2-norm for the commutator
 of the Laplacian and Helmholtz projection operators.
 A side benefit of the theory is a particularly simple proof of local existence
 and uniqueness for strong solutions in bounded domains.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
By the ruler method, 
\begin_inset Formula $R\rightarrow\pm\infty$
\end_inset

 as 
\begin_inset Formula $t\rightarrow\infty$
\end_inset

, meaning that the solution will sooner or later diverge depending on how
 accurate 
\begin_inset Formula $C$
\end_inset

 is chosen.
 Several very long simulation indicated that...t
\end_layout

\begin_layout Plain Layout
graphene sheet as grid and transistor sensor at the same time...
 pathfinder to determine position of nodes- spectroscopic
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Kirkpatrick: 
\end_layout

\begin_layout Plain Layout
Abstract 
\end_layout

\begin_layout Plain Layout
The projection-2 method commonly used for the non-iterative time- integration
 of the Navier–Stokes equations introduces a second order in time error.
 This error is reduced to third order when the projection- 3 method is used.
 It has been shown, however, that the projection-3 method can lead to solutions
 that are unbounded in time and, conse- quently, the projection-3 method
 has received little attention.
 In this paper we compare the stability and performance of the projection-3
 method with that of the projection-2 method.
 Both methods have been implemented in a Navier–Stokes solver that integrates
 the three dimensional equations on a staggered Cartesian grid.
 Time integration uses a second order hybrid Crank–Nicolson/Adams–Bashforth
 scheme.
 Results are presented for two test cases.
\end_layout

\begin_layout Plain Layout
\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="22" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t^{n}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\textrm{R}_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Delta\textrm{R}=\textrm{R}_{i}-\textrm{R}_{i-1000}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\textrm{R}_{i}}{\textrm{R}_{i-1000}}$
\end_inset

 (
\begin_inset Formula $\%$
\end_inset

)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.8950219438$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.26673602796$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.62828591584$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4.716937$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.45020097204$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $3000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.0673817922$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.3504447922$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.37284962903$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.30546783683$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.65316482875$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.28031519972$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $5.91653850579$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.26337367704$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.16678695064$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.25024844485$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.40596008259$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.23917313195$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $9000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.6353648085$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.22940472591$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6.85598340748$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.22061859898$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $11000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.06863234512$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.21264893764$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $12000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.27402698082$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.2053946357$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $13000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.47280762821$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.19878064739$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $14000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.66555020636$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.19274257815$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $15000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7.85277172869$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.18722152233$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $16000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.03493434693$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.18216261824$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $17000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.21244922202$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.17751487509$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $18000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.38568055249$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.17323133047$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2.1\%$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $19000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.55494975222$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.16926919973$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $20000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8.72053966795$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $0.16558991573$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Conclusion
\end_layout

\begin_layout Standard
Coarse meshes are extremely challenging to work with if we don't have detailed
 knowledge of the experiment, but if we do, we can save significantly in
 terms of computational cost.
\end_layout

\begin_layout Section
Temporary Notes
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/Users/Mo/Documents/repos/master-thesis/src/BCinout.py"
lstparams "caption={inn inflow and outflows},label={BCinout}"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/Users/Mo/Documents/repos/master-thesis/src/walls.py"
lstparams "caption={walls},label={BCwalls}"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/Users/Mo/Documents/repos/master-thesis/src/BCLids.py"
lstparams "caption={lids},label={BClids}"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Conservation of mass
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sum Q_{in}=\sum Q_{out}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
A_{1}v_{1}=A_{2}v_{2}+A_{3}v_{3}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
A_{1}=A_{3}=400,\qquad A_{2}=100
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{1}=1
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
A_{1}v_{1}=A_{2}v_{2}+A_{1}v_{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{2}=\frac{A_{1}}{A_{2}}(v_{1}-v_{3})
\]

\end_inset


\begin_inset Formula 
\[
v_{2}=4(1-v_{3})
\]

\end_inset


\end_layout

\begin_layout Standard
Bernoulli 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
P_{1}+\frac{1}{2}\rho v_{1}^{2}+\rho gh_{!}=P_{2}+\frac{1}{2}\rho v_{2}^{2}+\rho gh_{2}+P_{3}+\frac{1}{2}\rho v_{3}+\rho gh_{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
P_{1}=0,\qquad\rho=1
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\frac{1}{2}=P_{2}+\frac{1}{2}(4(1-v_{3}))^{2}+P_{3}+\frac{1}{2}v_{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
(4(1-v_{3}))^{2}+v_{3}+2(P_{2}+P_{3})-1=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
16v_{3}^{2}-32v_{3}+16+v_{3}+2(P_{2}+P_{3})-1=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
16v_{3}^{2}-31v_{3}+15+2(P_{2}+P_{3})=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
k=15+2(P_{2}+P_{3})
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
16v_{3}^{2}-31v_{3}+k=0
\]

\end_inset


\end_layout

\begin_layout Standard
http://www.wolframalpha.com/input/?i=16v2+-31v+%2Bk+%3D+0
\end_layout

\begin_layout Standard
solution:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
k=\frac{961}{64},\qquad v_{3}=\frac{31}{32}
\]

\end_inset


\end_layout

\begin_layout Standard
integer solution:
\begin_inset Formula 
\[
k=16n^{2}-31n,\qquad v=-n
\]

\end_inset


\end_layout

\begin_layout Standard
solution for the variable 
\begin_inset Formula $v_{3}$
\end_inset


\begin_inset Formula 
\[
v_{3,1}=\frac{1}{32}\left(31-\sqrt{961-64k}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{3,2}=\frac{1}{32}\left(31-\sqrt{961-64k}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
A_{1}v_{1}=A_{2}v_{2}+A_{1}v_{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{3}=\frac{(A_{1}v_{1}-A_{2}v_{2})}{A_{1}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{3}=\frac{(400-100/8)}{400}
\]

\end_inset


\end_layout

\begin_layout Standard
With: 
\begin_inset Formula $k=15+2(P_{2}+P_{3})$
\end_inset

: 
\end_layout

\begin_layout Standard
http://www.wolframalpha.com/input/?i=16v2+-31v+%2B%2815+%2B+2*%28p_1+%2B+p_2%29%29
+%3D+0
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
v_{3}=\frac{1}{32}\left(31\pm\sqrt{-128p_{2}+128p_{3}}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

NSfracStep/NSCoupled
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Jeg skjønner at jeg ligger tynt ann
\end_layout

\begin_layout Plain Layout
Det startet jo som et fyrverkeri,det gikk 2-3 dager fra jeg fikk oppgaven
 til jeg hadde generert begge meshene.
 Men etter noen uker så oppdaget jeg en ørliten forkyvning som såvidit var
 synlig ved en av de siste linjene.
 Det endte opp med 2 uker tortur med 12 timer hver dag for å finne kilden
 til forskyvningen, måtte til slutt kaste inn håndkle og slutt begynne på
 nytt og denne gangen beholdt alle(11) desimaler , noe som avslørte at det
 var forkortningsfeil som hadde forplantet seg større og større.
 Jeg fant ut i ettertid at gmsh støtter trigonometriske funksjoner, hehe.
 
\end_layout

\begin_layout Plain Layout
Resultatsmessig så er jeg ufattelig skuffet, men mtp arbeidsmengde så kunne
 jeg 
\end_layout

\begin_layout Plain Layout
Til mitt forsvar, og uten å unskylde seg 
\end_layout

\begin_layout Plain Layout
Skjønner ikke akkurat hvorfor noe er raskere enn andre
\end_layout

\end_inset


\end_layout

\begin_layout Section*
APPENDIX
\end_layout

\begin_layout Standard
\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Å stryke hadde vært prikken over i'en, isåfall så kommer jeg til å flytte
 i en hule og finne opp programering på nytt.
\end_layout

\begin_layout Plain Layout
Jeg går ihvertfall med litt hevet hodet pga arbeidmengden der en dårlig
 dag består av 10 effektive timer.
 På en annen side så er det flaut å ha så lite i forhold mengden arbeid.
 Dette trenger ikke sensor å vite, da det garantert blir trekk pga åndsvakhet
 ;).
 
\end_layout

\begin_layout Plain Layout
Jeg har på ingen måte gitt opp å komme imål, har generert en super fin mesh
 for pulsatile turbulens simulering.
 Har ferifisering og diskusjon På en god dag så skriver jeg 5-10 sider.
 
\end_layout

\begin_layout Plain Layout
Mange av figurene er med pga dokumentering..
\end_layout

\begin_layout Plain Layout
Jeg har hatt mye med sånne feilmeldinger å gjøre de siste ukene:
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset FloatList figure

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintAll"
bibfiles "MasterCite"
options "apalike-letters"

\end_inset


\end_layout

\end_body
\end_document
